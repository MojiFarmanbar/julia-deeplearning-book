<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Julia for Deep Learning - 2&nbsp; Chapter 4: Under the Hood: Training a Digit Classifier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../summary.html" rel="next">
<link href="../intro.html" rel="prev">
<link href="../logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta name="twitter:title" content="Julia for Deep Learning - 2&nbsp; Chapter 4: Under the Hood: Training a Digit Classifier">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/c4.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 4: Under the Hood: Training a Digit Classifier</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Julia for Deep Learning</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pat-alt/julia-deeplearning-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/intent/tweet?url=|url|" rel="" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/c4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 4: Under the Hood: Training a Digit Classifier</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#calculating-gradients" id="toc-calculating-gradients" class="nav-link active" data-scroll-target="#calculating-gradients"><span class="header-section-number">2.1</span> Calculating Gradients</a>
  <ul class="collapse">
  <li><a href="#using-flux.jl" id="toc-using-flux.jl" class="nav-link" data-scroll-target="#using-flux.jl"><span class="header-section-number">2.1.1</span> Using <code>Flux.jl</code></a></li>
  </ul></li>
  <li><a href="#training-a-digit-classifier" id="toc-training-a-digit-classifier" class="nav-link" data-scroll-target="#training-a-digit-classifier"><span class="header-section-number">2.2</span> Training a Digit Classifier</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/pat-alt/julia-deeplearning-book/edit/main/chapters/c4.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/pat-alt/julia-deeplearning-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 4: Under the Hood: Training a Digit Classifier</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="calculating-gradients" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="calculating-gradients"><span class="header-section-number">2.1</span> Calculating Gradients</h2>
<section id="using-flux.jl" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="using-flux.jl"><span class="header-section-number">2.1.1</span> Using <a href="https://fluxml.ai/Flux.jl/stable/models/basics/"><code>Flux.jl</code></a></h3>
<p>Taking gradients in <code>Flux.jl</code> is as simple as calling <code>gradient</code> on a function. For example, to take the gradient of <code>f(x) = x^2</code> at <code>x = 2</code>, we can do the following:</p>
<div id="1b4338cd" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span>(x) <span class="op">=</span> <span class="fu">gradient</span>(f, x)[<span class="fl">1</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span>(<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>4.0</code></pre>
</div>
</div>
<p>Below we implement and visualise gradient descent from scratch in Julia.</p>
<div id="68014750" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>xmax <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt <span class="op">=</span> <span class="fu">plot</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">range</span>(<span class="op">-</span>xmax, xmax, length<span class="op">=</span>n), f;</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"f(x)"</span>, lw<span class="op">=</span><span class="fl">5</span>, xlim<span class="op">=</span><span class="fl">1.5</span> <span class="op">.*</span> [<span class="op">-</span>xmax, xmax], </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    xlab<span class="op">=</span><span class="st">"Parameter"</span>, ylab<span class="op">=</span><span class="st">"Loss"</span>,legend<span class="op">=</span><span class="cn">false</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>nsteps <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>lrs <span class="op">=</span> [<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.975</span>, <span class="fl">1.025</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">descend</span>(x;lr<span class="op">=</span><span class="fl">0.1</span>) <span class="op">=</span> x <span class="op">-</span> lr <span class="op">*</span> <span class="fu">df</span>(x)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.75</span>xmax]       </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">repeat</span>(x,<span class="fu">length</span>(lrs),<span class="fl">1</span>)                             <span class="co"># repeat x for each learning rate</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plts <span class="op">=</span> [<span class="fu">deepcopy</span>(plt) for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(lrs)]           <span class="co"># repeat plt for each learning rate</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> <span class="pp">@animate</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> x <span class="op">=</span> <span class="fu">hcat</span>(x, <span class="fu">zeros</span>(<span class="fu">size</span>(x,<span class="fl">1</span>)))                <span class="co"># add column of zeros to x</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i, lr) <span class="kw">in</span> <span class="fu">enumerate</span>(lrs)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        _plt <span class="op">=</span> <span class="fu">plot</span>(plts[i], title<span class="op">=</span><span class="st">"lr = </span><span class="sc">$</span>lr<span class="st">"</span>, ylims<span class="op">=</span>(<span class="fl">0</span>,<span class="fu">f</span>(xmax)), legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scatter!</span>([x[i,j]], [<span class="fu">f</span>(x[i,j])]; label<span class="op">=</span><span class="cn">nothing</span>, ms<span class="op">=</span><span class="fl">5</span>, c<span class="op">=:</span>red)    <span class="co"># plot current point</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        x[i,j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> <span class="fu">descend</span>(x[i,j]; lr<span class="op">=</span>lr)                               <span class="co"># descend</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        Δx <span class="op">=</span> x[i,j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> x[i,j]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        Δy <span class="op">=</span> <span class="fu">f</span>(x[i,j<span class="op">+</span><span class="fl">1</span>]) <span class="op">-</span> <span class="fu">f</span>(x[i,j])</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">quiver!</span>([x[i,j]],[<span class="fu">f</span>(x[i,j])],quiver<span class="op">=</span>([Δx],[<span class="fl">0</span>]),c<span class="op">=:</span>red)          <span class="co"># horizontal arrow</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">quiver!</span>([x[i,j<span class="op">+</span><span class="fl">1</span>]],[<span class="fu">f</span>(x[i,j])],quiver<span class="op">=</span>([<span class="fl">0</span>],[Δy]),c<span class="op">=:</span>red)        <span class="co"># vertical arrow</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        plts[i] <span class="op">=</span> _plt</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        plts<span class="op">...</span>, legend<span class="op">=</span><span class="cn">false</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        plot_title<span class="op">=</span><span class="st">"Step </span><span class="sc">$</span>j<span class="st">"</span>, margin <span class="op">=</span> <span class="fl">5</span>mm,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        dpi<span class="op">=</span><span class="fl">300</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">gif</span>(anim, <span class="fu">joinpath</span>(www_path, <span class="st">"c4_gd.gif"</span>), fps<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-gd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../www/c4_gd.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Gradient descent for different learning rates</figcaption>
</figure>
</div>
</section>
</section>
<section id="training-a-digit-classifier" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="training-a-digit-classifier"><span class="header-section-number">2.2</span> Training a Digit Classifier</h2>
<p>The MNIST dataset can be loaded in Julia as follows:</p>
<div id="2387f409" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> MLDatasets.<span class="fu">MNIST</span>(<span class="op">:</span>train)[<span class="op">:</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y_enc <span class="op">=</span> Flux.<span class="fu">onehotbatch</span>(y, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Xtest, ytest <span class="op">=</span> MLDatasets.<span class="fu">MNIST</span>(<span class="op">:</span>test)[<span class="op">:</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ytest_enc <span class="op">=</span> <span class="fu">onehotbatch</span>(ytest, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(<span class="fu">map</span>(i <span class="op">-&gt;</span> <span class="fu">convert2image</span>(MNIST, X[<span class="op">:</span>,<span class="op">:</span>,i]), <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">60000</span>,<span class="fl">100</span>)), ncol<span class="op">=</span><span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAAAAACi5bZQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAIABJREFUeAHswQdgTQfD8PH/uY4kQogQBEnsvVft3Nh7h6KovbfUSiQxqkbsPWq0asQWtFZuzChiryi1KoogskPu+e7NvPecc/Pg7fs87/e+fj+RL1SJfKFK5AtVIl+oEvlPqjerfSRq/McD1RuOdKVRMP+gEl9R6AdBAg3/gkgGzcGIYxv5ZFkbsqmg0C3i+gss+/nMShRyLKni5Yma6UCVozmRGP97HAo+Pp7+pKh6GRNZyvXqk1ejZ/Okv5GxtR7YEOcKIEmocW7dqnVMhzMJpBDJUKlJlnonHmOZd8PGv9dGbuxskKSt7A5ehkK9pBAMOnvsRKloFUqjKhK7OW1zSUDramdQ6CvlIcX2Rl89IF15n04g/fWuVK8XE5HxG0ea4DpWyA1cJSFlP7J6XALJRDJcOdLS1ekxlnT5trGVJCFTf25FUnRqbrU4CXM2P20KwaC/GImqQNTZLvyWZFE5UBha6Nl6jIThDT5EkK7Jfmsp4udf70XUxhGZ0t2Bv2M5uBUe3rJCxnkWEDZ67eA/55NMxFzL86jL3nNG3g8J1neRsf8KCIoB14rZ5+WckYSZfq4YNWz8SxBKBWAN6lp/C8EPe8O9EOTKTtVsuI9Rq8X8HEm6Rlbx/X7/EzhKeWSiHif8zPZbGLW0Rs7BCkKjj66c5RV0CSMRE4EteY663ENGOe6aO6rKRlQEDHkLlTZWxvuHJMwsfLUKg0biMVR0xRK3dQI0qmLTjRpjV4djJttWp8vLMSq0nsvfkcGROdtJ0XJ8P8w862DzGKNsZUsuv7sMmavvcp2tBycFO7dLGImYuAIuqLIPrI337Po99r7CnM1i0I17C1zreCUnOeMxNSrrzL+B3N8+DeCTdLGRzq3gyrcnVun7bMHc5Ioc+hsDq/mOCUv/JsPJfrGkqlEOmRcY5fTO0weKRyIn6SWw7iXxjGQi5iqiJv8518cdrmaZQoeCdTDjXgS0bdZg8Oh4R3bXx4TNqGdLMRjqPC4WVRGoKjJM4sFWSAyutzV7qXuY8vDkZz8MxJ+6MGYTJs6cK5D7DUalnsaWu4Wcu+A22BGDO8tnoqKNbxVmbCOZiImYKDtUrXO90+kug5rCQ8y0XwXRnqdJNrMjxdrtJ8PookswyNIh7jfUbUFNnsPw+1QM7rF03o/tQ8jguiXLn9OSgGw9uvDNDkw9qJ/0fn4EVBzRLWLFLeT6rs5Cinx+M5EJLey0or8ohS0ihYiJa783zp09BoVBLR72ePhN51YQPBozNfPxttsxUiS+tc9fYz8ZBvNT4RLQsPqpAgW48haZrOWpgooik0typXM4ydoRFUGG8sey8O0jDDzWsGF3EuZueRbqXX5MR/vA8fdRqJcF4g/BmFfhuZCb2b7IYPTTZ5BKxFzdUpdRaKUp0qF9ZUFi95QXyM04Rqpbs+Yhc/ZDNhCkBscRjjdF5v3NOlVR8fUAND+Gk+JAw6KV75Gm6s58vK5UHKjbiy1D3yPT5FhNt635N05+/QGl9/GJ/eIPo66aJMH0GaQR+Qj3YRoGB4a/wEy5Nlz5DYvad3GRwu7UmnxxdymEzSjpN6CircTq1aSSJEy0LQp5lmEgSLG9Ufh78eoTsbUvoGroUCxqPAuY6E86kY8w630N9p4JJfQF5nIV4ult0tjkxdz16xgUlzYv4xPdSiJFkZGYOjQhO6mkmCIPUcgrEXABc04QkYip7+dgrvoBK6C1P+lEPsLrSZA9SJrzAzLnVk8mQ5mJqBnxdCPqzvWri1KdkrCEFMUDXaXfQ0h3r5lY6BHg14Sz4x+iYN0oYvWEW/Mx85fEsoDTmCiCGbugqkRPuHHazS6KNCIfaUqJi8sS+Qy1C/8UjboL1EBpmMPbmaQYPaQkVzqHky4yBKNSBdjXMxal3I2OTqs7SzMXU4LECI9z3mEfSNMDM95VpYhOZ/IENxywkDQiH6fUcLvFf6Gi+fTZcaQoDhdmI1dUc4VPcqBHblIMHO3K5caRKEytcKRPLCpqAO1PTE/yx8SOLpC/Q4fFMX4fSNbWBjNVYfUZIlY27LaQNCIfpcgmu5U7UTob7jRV8sGocmM/2BaHTJauHwKwbNAa5CSJSqUqY+8l5M8iXVkSiULFbnHb36Hm9wSBmEaH5mpWRZGuf14tBqPpuejilHKAw6Y5mDrUKHQmRtW8Z5BK5KNUqXp+UQJKh3od47tqKw5Doc0VgFXIVWy3NxwL4mOyF8v5Dpl6UXa9tS6AIN1YcSAcpVlZd21E1YudjRqfjBl4cHbvr2+SJnrhi64YuS4kxaRITC1sX6LUDazzCGKLGaQSMXf0Oipyrsw69Q/U6Br/7NSqaRII1sRcm5qAXBmCseTe5CXftdBN+ICZMTW/wlUCnl7uH4GKUS3Of4sFG1v+dnJlQO3t2osj1pMmkGb2pLt7f9M7zHntDjy/3tNdStxMGhFziR9Qyn46X49gVEm6gY3GZc2KkZ8/Cg6j/vgJizY0e8BNPTJLj3oBb2cuQlXXKVnmv8eCoG5+DQ/lttqktRq+nnSBozaTZuqBm8id9pjVuYsEp1eTRsSMIKCiU/ldAXosOHzsEJsKwf4lp1HK+ZXuDRbFtkfFNnzJRA/H4xexKChk4oVOXfa0r7kEE1u2kKngZk0aOknh00knYqopqjq/G6bHovdBuGDJwyz80zqQqThfgtfDQT5J7P79mBH5CB34v0fkC1UiX6gS+UKVyMepfvRtizD+DxH5OA1zvnfgc/Rc1+gc/x8SMeM/zm91OEqjR0aEhvDp8u+tFncJSyo8iuK/Qa6pDXr/IfFfI2LKtqTeq0YbFPIMcV2zis/gWiu2byI9vHwCUMh/rMyrfUOwxPHhw10z3mMub/2jMSSrPLr0+BBUFGq4yi4+KGTaLdQV2Vi8Vjj/koipHFUhF0pfl2TmX1hg3WnTvcofMBgdv/UdpvJ9z5k9sDLH1wHIlV5Wjnz9p71AXdPvs5X12qkdE+kdSIZpIxIORVL0K0ESxcB7KNl8831eohLsOjkOv4Gawd/nIndssxpZx6FU0JUbUSQTMfVi+1hU1FmCBkuytNjSL+ADBk1nnN6CmZXubAHuV3bM+Q5zFX6qBGhW9Y5GzeiZ2YErwLJAMgQPtK7+EH4XpD3nLyShkGNHC96cnXPaaV+D4jdQyF5yaieJ9x+8xjIfc42baKVLbVylPb1jMRIxZe+GKonVz7Gg3+qXATEYrYv3isaUQ2keHwPahdY7OuQyJqymD7THqP3yPqgYM1fkcPxazfbswp+Y2PVt68G/YZmNC8+6hEB4Iq4o5PuhN/Bob1h77izDTMF1LoL0VaiXd8dt7TASMWVXTaMXUBOdhDqHMe9axmCg6ZpzcShm1pSNXxAOPF04rUbpy5ho7EmqthVuoNRclAJ66PlG5OkSTI2vM/pkHBa9alYh5B0GpVFqOKcmvPn66suKxaUdTzHzbGP/k6FhwU7x8atJJmJG0kvTUbCHd1gws+z6UIxy/pJwEDP1G3NtKUaz29dc8ncQGSaQxn5BMxQcqrO9B1nHzMzKhD2YCnvSovlvcVj07BkWZG+zVSI2sDvivHGaS/OQ8fMDjteOGHKQZCKmXIE+R5Dzgumoq/R12FSSDWLPBcyMyUkCKXocd1lWngzuEnAtsQYgohT/Mm9R+7fd5vBi9g7M7ay8+07k80LnFzxOwjJXG2RsJnhL0i3f3TBzrKT3j0Op4Oq6kV1vkkLE1EjABQVBwC0YVRPtf36BUYVpTMJcbe73IcWDFy6YmjAPGH2q5QEolScCudh7Zb9aemQNSd2DkFlk65EvX0mh+vDD0y5hUbPsrMfMJC+41CoC1z0VYcxO5Lq3qnHgVf+gcFKJmChSCTiAwpVatA3GKE+jq2GYO0GyFrZhbzEzoiA9H5Fq6pFyvTeTbsHd9k933uLQ9UpCwRwRQO7o95gYXrZkz57wXRByMVOnYjC1WJetw44hl9vbDaPiLIrDVJfvYMbyCAodLcbbyWuRcX4Ez31jySBiwqkUmuErUPhpEN3nvISC6wqVf/R3+5eYSHiMkaY9y95hTsKEJE3bTIaDUcXcOh1uUFwiMhaYOOmo910y/PX9BojvuRdLZrEpcE+H45hyeD+pXPszElDLivaLHmNimBU3fKHfdCfpZN9HyEVs6pRD2qyffoM0IqYk9PtQVcAKcfCAiuBaZOSsBDJYdwsFXLT13q3AvvANLDh1pp4VJsoeFcEPg5y/Rl8t56bp3CoHJgQgcQ+ZODlxxbymEaQrMc39fci0yXclKHLZKt6lu/8HMggCOxxeLx5BYsMLKMX29c8RjlPUsjlPSCHyER5erYz31h79hb0Po7yYkmUq6W4xuAngnJccF8i5axIWJCRgKpuPSJoq1MfgHSZqTwFEp3AysbpG377zSWN93DnU5yBG1RbmutBn6ux7u8kgSUzv81cdiYYXUHUDeMTyg83DSSZiohdg/xcK4Y2P1hg4EBaNB7txejcyzLIaXhVePM3Lldhtt4MwV/wCqRwcuE+GXB7IPSdD53lFkoIb2dbZTSb0f1KENIUPOv+46iJGzQY1iB56Z0/PKbvJEAeUKM6dTmFkJtx6oncURiImKgMBLR+h8HbpmEqwb1u2uDol9ZKECZ81dhBZ8MJfrV5gbm+/ysvqjyCZQ/cq8fPIkBhlh7krLUlXeIWjfsqDRpQhU4/I0L/cmCN3MLAf1qb2i8Gh1NS/xMTgEX0c4U6Lp2SqVIl7USQTMSEIaATUbD4a6kj7qhGJJR1gKab+wqAXf75A5un0JYW+Lrjz8gvBkSaLeHiIDK89l2fBKCEh9lHl+7fY9ms86U44Mn5xZ4gnU65k6CjdTcjuRK8KjXLF/7DjCmg0ezDxdNL5ANjxlEx19/feTAoRE5LEnVaPUBO+1MsKVxcgavxxFIoQi8Le0L2V27fnsqYyBgGYWntnRLT7s9PHTyag0KVEUucDDv1IOIiStZRIquzcJk0O8fD7OxWBN10fhAJ21Zdtw0xFQaMXkCs45/ICUlXfk6NSRBwpRDLkyQEtHqHu+wcF2mrh7czLwajZitLj9kOH2WStqtFD7OrNmDl1CktsiLnWYHFlrt9FqW2LYYkY5Ro86tRm0mg7kWJtHEbfO06OwZRNc0kvSchcqsoZZwyculXPv/arcNKJZGhUnk2PsGQbi7Dsw3ZUPJkypU31aRC6a1M4nyDnAyDaCxX3VlXdH3DLKkeNZSVejo8izdMlmBmJTI4qwAVkzro4LF+pB+Hu60ujMCVi5jqf6Y941AUG+vGJ9jxxBn7v8hQVV3v87ON1PF8V3j8fcZGP9yqwM7tOIDNyqQPJ7kVgTiRDQACfq04Q/5yYSnMHhuzaGIGqIx75OlJ+24ul9/kkNzu/8UpALgwLRP4R5TfyD4ocPBjLggngM0yfzqcQ+UdY8b+NyBeqRL5QJfKFKpH/vHFesa2v8j+MyH+a7eoe0s2rfIpem6V5E/nvJSLT5sB8T1Tl6eeV88A9fKP4J9k16g5FKl8lXd7FPS7O+i0Oy77R02si/7DsHadIe9Y+IpWITLRUEFXN1hZC3wpqdozgk9hOKvl11KzAm6iqvwtiva+SoffX+mq7Lgy5gkUr9lf4pk0gn6O035zLqNrcXpAmDyhAKpE0OZwdb0aQdyinUdNmn8SM3yi1vN4qDz5Bww8rK6DP/v30FkGoqLIGOLgRE5vmHB859ZsTS/30WLCPdoN2F3/CpxPX152DqkEdpbjbro4NT5JCJFWukxWJvEVpe9+fUdFmF+Ez1yURErG/dbVQPk4hx2+qNniblbC1E/KLa1rcR85tbFug0z5MRcwYHPntnkVeFXrFYsmZs3UFlNoWWGwjjI9q1Z4jywJR0aQuFpSRbne50/xgh5OkEEnVomLYjirFCZ+wERUVV4t/NQnD4KBg/d3XmOrXH4Rn/ufAubZw9inpCl3NDfyyes+bn4IO5i82xBO5tm0lmLEPc9N/fME+q3kdJntjScRrVAyaa4ckzQOJpg5n3qA0HksaCL3v8EpoQCqRFHbz4rtewyKv/FKTMJIFtsJUd68yEghSUS0DKvUSIqasI03cm9zwcP7T2lsmTrqdn4vItJnsAjcGP0buKRBw/ddJl3dj2eKOyC22Il311j+j5vpj1JQtI2EgkUYkhWvh09cwKPP3G5TquzMjDBWilzf6wBwFy+mrnBCqxr3LnWfCr09J9XrVXD4EPOVta2ZpORCIudn9HSB20XnU3WlyZeqvsairUxsbFFr0ZXQ8lYdVrALztqJUojxXIlBjayuUDcVRGE8qkRRu6MjVsn7NSm9nLUPhYPaDM0nVWiKDk5fE9BkUfCLtPjV2t7/1+FYljpYlzcoRLlkSsiSBx0SCvGIw41beARi8FUv+uFmjdQDqHPOiIjgYg99D51WBH5NQKlcgxh9Vt2+XLQNlpDInSSGSrv20qkdWuwxZlNcXc7bb7RIOJJHCTiCadN4wYwbOB0cSMiD6VM/W1hBGutiatx28sk6h5tJEn2VxmHHT6SHYc8TP7Du9Jho1M/c2D+Az5B0Fupco2Xpy7hqqypYV8sIggTQiKS4wKcvr9oeS+GWpd7vBFzDVuqU0fR2pvKWohaSrCuupPqucTasZOcQFIDybuY4Mr6bMyTWx7u5Ojn/Ow1yd8XoJKh/NKdGufakhqDmPY5YkVA2HqtsGRqFqMZzb8AalMvV4irop0qnTUPr2blKJpAgLz3NyWBgQ1n7K1CNNL2KiGy/WkMr5W3bfJF2nh3hfXg7zJRB4kThzLWbW/j6xboMG0BNzFfc5YJBLkDDouPQmKt4cb2Mdi4qeReuAo0fBjhGoqKOFRTtRtxF1HaVfttBQKPuKVCIp3pYU35Esflr2sQubx5KueisGRJBqqEP0YjJEnKvdX5AgRGJdNEERyF0df9gZ6HweMx+eOPBsS7PK8CLBPmeeHlNR8f41qr7zsYEHHh6dxnijYkBe/riJmmJcvYqqspK0GzpIEmlEUsWSbloV9zY7SNfUmoOkmjSRRlfJEDs1wIGQE4dCsKDQ0dIYdPkOM+sqw5DVTjBjTfj8sexHjVVe1PSenhWkDVeubH6Gku3S3iyc+RY1PbgYiaoGwqlXuPYUepNGRCnmqrsjGapKpKk4VFp7CVPB974ieBqWFJxXGhY7dyrw1XlMCQKn8hcEzbpw57Gay49RY1MEFQ59swIvvoe7qCjxLW/XvsWC7ajrKO2BBXl27yGNiFKxnrxDTalf858YjRlra0GYVGT4W9Qt6szjKtELeBGKqSrOEg0qShDUYFgxST8wArm6bY+dausSK6GwqiGZmQe77vKJsrsIp+jUUfKOJY1Imlpd5r3EqOo2xy1bMRVKslJzCjwbm4iZ1lWk0KrdJr5FVfWG3KgXPbgdD95j6sqhDnnIBbg1BLZdT0RmhI/Dd8H1omfHIVe/AQYJa1HXpj4v12PBig6oK1NaotMm6fZt0omkcj558iXgWG50S+utIz5gQqiOgejlzV9NwjDXDTr9iQXVDuWV5sZ4eDvt64252ZXykCpi24+JyFV1ADdebUChaD4MirxA3RgbTpzHgm+wQBA09LSN60IGkVQFrSbi0KKLey4eb50VjYlwie0HhVa2LSWahCET2pn+MMAXFU6H8hJwqPk2wi5GY+5hs/4N22Fw5eeD91A60d2a8A/Fj3V6gIqE6a+xoDqnB2HJPQF1kqTfXFbafYcMIqkasDxL2RyEhuw8H4cZ70Idu3QGQVr1cxhyc6zHTJPiLqBmkCO47W7Ih8EnkYtatIhMbPlTe/VM3Loe1yfY3t+LqZBp0y8u2I4FE3PEr4vGksMzUPf4SZGympnemBBJtXdubV78tjI4CbmoPje9YW3MwTOJKE3fVomnIaixA/Lnlw7MPccnO3sWGLTTa9CNjZi5N2sWFmnya/7+CYsaYsHLcTulb/ZgSiTVHxosifX1xbKwMCxYn61WtR+FSyv5XHH79vFJBo/mBJbtGIYFe7IgI/Lf5/Zw/s2+4shYLHtWio8m8r/JmPzLovhniPxv8rYl/xSRL1SJfKFK5AtVIl+oEvlClchHsqo6vakgwetmocgUzdm02O3bHR/U+/YdMhu9nvIZgrTuOiyq/cOKHViS+/WdanF8jqFTCsL3P8SQTOTjuK0tARLgMLs5pnJ26FM5NynmDiGDXe91CW6tXnqiwvbknT5JWKbFR4uBmxbQuWOmwQ7HlzuwSF+q6yY+Xb5h3pIEU7KPI5mIKZsCXeoJJco9L4hM3nXFMXieIwe2Gj3prEd7ZQf9A17uth9vkx8TvRd/+zqHQ3dPwNah9Hf0f0o6KbpH0oD3WOTno9WSRouZrFMcE+eTzHn22RUoOSPX3BGWbz8JcbuwoLoXyWpki8NIxITHLOeDdy+Ed3yMXLvixN5df/JpzsL769lGk27FtxDR/UMwkLNT0npMhFJVkCjwWCK0VtYcVsLQqaSL+/rPXnnDtv1BXOIHVPjipgV0wbhp0WFmflMGnceoxL7S+hXIOCBn5Vultj0wYAAk9CdgcxIqCgLPCoJ3HMlE0tmu77xl+p9Q49vvkNtbtei4MOBtLs2LD2Top389OOQZBtm/LxsaiCkBjR4KSxQWJBCaTU8g3fPuq1u2HA2X/nzJlR+TkPMllQTumBo2mDu7SbajNEoVkOs6iXTWLWiRdQ1K2brBvvvjOPmMFCJprLfWbXAeKLmL35F7PZIUa+1vCmQ4rfE7glGugMbhfTAVtru1tQRIgARUrRpChr1BXZz6U6BQXgqJp+5ggTYI3DGTU3zRPhYDTf+SvF2B3CVUhMfD8MhaoyCXA/NZp0eudBFBsK0lvBl1jxQiaXxadT8PlL8hnbmJJW1K0jeODI2FBIyy7NbO23ILUxEeA1ZjWeR6ZtL80it6LxkxAnW+Puj8dJiyaUr8fYx6reRtmxDkYpC7PpO1TzA4txjq9xiSY1XiRuSGFpNoijTzOqlEUpWctHYn4D8iKusaLLAa6Jc78AYmEknRV/vc6wMylyHsuV3VbQWrr+HyT6j4DYOcr1Cl1fqgc8ectRsTMBo1B46H8BGuXiXD6Wcd89NlI6Zq/Q4OGEjfbieNSKoCFMtmW2bS8xq7PvyEkl2H3DCwPPf6x6PUb/GtdR+QcxPoF0Kq6mNQ5fANq1Dj6wN+vsiMg3iwKdlwZlbuLEMp/kYFMvNg/RRkIoCDxSrDlC2kE0l16nCLp1muep2tVGISKkbNwGh/j1iUxK42v25BIXCeRLrWEqp+bIIKXx+M3JArDt0O+Rf0ECRo+QSluKsVyNSf8TZNOu3GxH1gY45FcJ8MImk6teD5eZgbMRelnJMxiJi1JhYV+5reOvsKhTAylCr5KgIV9Rtz+A0KPiTTSgLmTnfnm28AjR51di24S2bWe7la2SAnthY0+mG7SSeSJmEfBmVqr0RFYVsMxv2Emnr1Yzv+QeZaY2eHkqNf9nCfBBT8wBd8fZD7eUIR4Nq74Kmsf44KMQ/v+HR7m0p6qVrhp6QRMTfPdjoq7v/4+nb3JvGosR2UY8IfqDnVoFoIyfJPEC6HolTLnVUXUfLFyBcfZKLbVQKOvxyH9PQ9KipBzd/4RPnmNw/w2VzDyvEpaUTMONXbEI2KhAHwqAmqcn+zazmqvHZ3PHkDA7sf8ksFnMJRGMiSuVjmhsKtWxjNkwJmoObi/eK3+ES1/Joe95QcyJKTdCJmlmb/DrmCz0jmRgLqPBNRdTqo86+FAdsNHWBROAp1m7I2AVNaLb6k0WpRl3MZ7EeVWxFOkJn+BUiIw1Sh3U7SD08diksaa9KJmCrcZNhrzImDVmBk7zMk9iBqqpNOk6dH0NPXpAvtXOBx4D0m5AfCUfLMdvQPzASBmzupgtChyrUHN0+iqnoWMlfUmuN7MNXfSRgVlP28Rr/vCOlETK15tgeZgd+dAurUberEgCTU1OCrR4Xf1cpdoRzWrRlddjjp5jRqUngwCBLc3YmCU7knExKQCyZVEDp3VHWAN8+wpMJpLCvWHxn7YdLJxEMFiuqlbWQQMdG3Ua3XmMs+z/YqKeZuQtUHtszMFV8Yg/iTR25sx8ScEkUkQCK8A0o9Sh28jjn3IHx8dME6tPiAH+qaQO0uO1HzNia79jSW2eRHpl5eGjYAorcGk0EkQ9aeP15DRmNLij83z0xC1cpuZYpjEHHpl0C7x5g5Uf8pRqvmPUKphSQhoxO0Wny0Phj4+WLBM0iIQdXSmj0fkylBCsPUnyG1MeqzFxMiGXq4z0YufnCL6uFOF/bfv5iIBS/rTO1Y/OWus6cewxtkwsv3714geMaZRD6WTodOC+h0WDRC9/Wiw6jzz7efTEn4YerWhssO3S58f/8WpkQylH19HLn3a9fyr7ybOBGL7nh6YsnpYiNQo9ORuYjVq7Hkagsy93bQO8ysh57IiZg4zb+Xnx//Abd38hFEMkzi/4BbGj6KyBeqRL5QJfKFKpH/UxoenO/HRxH5GKUabEzic43zf+KCRfrb5fk8DoevDuLTTPTMNnzJGz6GyEfIuiLf/pd8Hmd/D55imVS67G0+y1c1z/BpGo2355QNas5mbRSFKRFTvrhpQcCclZ/215cYWVlFo6LAEo8/hh5DhfP2OsAiLGooYEHL1c4S7F0c9zvqmkWtRE2lWa0hzK3NemQa7rB/0DsEVVLVAQsxJZLOFzctamp58hyjMv65/rofcCsBc67zWyxsuavVGRScHz/hCc5ddmDJZEm6jZqSSwtLQIcO75/4r0RF01Fn7qFU4aeStlK8TcmlE5FrY0/vEFRVLM82Uti2PhEBiKTw9cEShy28W4JBqUMuwHenRl/DlP2G6kN/Dtxf4wwKY1jkv2jBDo+uO7Agr7AGVWOK8ceogo/EnoStRE0nYRdKFX4rQMSKPXWWuScik10rhN1H3ZgcoeGk2N5y1ApAJJmvD8n8dEHI9S/EtWtA8aPvk51VAAAgAElEQVSFMGrg5/GBDOISN7+fORFWv9DcV8icx//JAro+3r4DdWXLSHdQVRdW/Ar8hrqB3S+uQqHywQIc6xpJPHf+QmZ/9ccjXqJqyLdx7Ulh1ya+AgYiyXQ+umB0OtQUhh+Bkr8VlqKHVKxXn7bDlpChZM8jM4GDUzi7F5kdX40LAOo99h+Pql22T7agpno57v6OZbl/yLE5AblSv+Zj7MZ3NPEjf65IzBR8z+XjqFsuBYaTrM5y/fTZGIgk0wlYkrUsvAD2uHB+duC27H0X4b2EdFmPP/taD5r2AntR8GA88GTBuPGoKi2dfIWaGVkTJp7FIs2S3BuWoTCpwLuKjyk5Zihcj8Tcd00i+qOuO2wjReFKcUEYiZjTgg4z9Rvx8hHMK8X7ySch5kxkrtxkaF1gVCS2NXqWl46g5PwEo/Hj/MejwlHgNGpylePofiyr0DNqNkolpRt5v2ZyTokL/VD48AYjD++8grRzxkvSlPqBtYdIMYCjIRiJmPMBP8w0hr9uU7aPhrYnMbj8Khemks4VaNrPTYLVKIwjgGQLxo1HxWRJ2o2avi7MIXvCB9TZbuGHP1Cwj6f2BRAkgrpGYm5Q95ONIFuu/dUBjf75S9KNLKwPTCRZxQrCTJKJmAvWotVhaqpemgnV8hB8FKOeJXhPhrxx9zcKe/t+6x1yGIXa7CTZonFdd6BQfbTQ+xVqhhB2rfvMu61Qt6H83Z9Rett2Risu1i9K1A+vMecyLc8FKDa/nSBFPyiX9fEG0rl1k9YeJIVXfukSyUTMuSGnl/7Yi/V3En4YWX8nxbYhQ2SOyV8n5u8xIXJUAgoenCPZE7rsQEniNhYUf2IrFlk8/gMqnNp86PcEFfGennCqKCeOIfPmWYEuE+22VyUxYNHza7lFa9INc2AGRo1f3StMGhEzvlrwRckxJ8fOYpCtR3n8T5IhYLZn21f1P4hhl/hkU4S4WFT12FwiJwgj951AKfuxbAPOYUnDegJnkROt0eU5XZKd0x1aDbA/NfAhprq3KokgOSbG5CeNiJwfKqxFbr8Hik7py7Y5mHKf2tR6UtLcU6h5QgpndqLQqYO0+w6qQitUKUqeURUWVULJu+ytbVg0SeLZKuSiI/Bok4dbocftbG75T48hw+v3VvMlEBJekFsgmhQiZtxQd/9Sm3Yr7hUvvzI/vwyJx9STIcC3/ElmPNiBQlmB3lhy5Qq4VUBFiSH0jMWiGvBTNHLvG539yk5P+dka/ZWtK2MwMfSqZ5GoGyyKCKLRkYhOpBAxowUd5h4ULbxjAzfauB7d1tMJzg+LRc0dVDxxJpmzfwBKHSSJzJTryF4Uck7KMek6Fo3OzcMlqPjmYq64MDh58Xg45lbtc426iVF1gs6QQsSE1gd0Osw1+a1Ep04YFPaU4NXkaFSFo2KR/7gFGPgzHoUW1TTBZKLAdtsX85HLMrbfublYZNNCQ1A4KuL1zF7ldAMV4eGk8CKdiAmtFp07Mo9azOlMmtcep1AlCKgI8Pc/d446/nUCnqDQQdJ/j2UOk8rHN3+H3MIRD0ZiUcmfa/L3HtTE6RnQd+0NMmMnnSSViDktCg97jupWFGpcFKRDoRGoqhf+ByqedNt+lgAPArqi1FC4fASLGi6uLP1wFbmBQ2IGhWKJzfIaUkyvY6h50yfQeb4/mZKkUFKJZND6gA6lD38vAawSsazLn9Go2VG4tofHuZ0LUOpUWtqNJUWGjBNfzPNHoebt8SewxG5HEym8+U3UHc7Cv3TjJqlEMmgBPyxJxLKKuXSoW4Alu7NggTiw0te5XgUNi0BpEJmY0Cz2WvMoPt+6+ChSiWTQ+aDT8Tkiec4/x2k5sb7rnvHJKgZu3sV/xWDSiWTQCXymxxr+QU80fJ5O/HNEvlAl8oUqkS9UiXyhSuQLVSL/3YrqXKpd5v87ImZcLo8VGkH9ovO/4zM4194uZcGcS2E9/6w8i/b7S7ydGYBFPr5XqiK3fNjKcz9hkfPAkl9LrQ+TQsRUqcn2K7NJIEjVkHGcWTZ/qadN75CZbbUkPTJNyUypXrnaI0zfE8HHc2rWXZAotHXs6Auosmvjqc9b5CHm7hbXDx70OLhTicBbKBVYX90RPRKpREyN741Nwptjxc5K1zFT1qtBIQR9we4+WNZ1dB1J0CBTC4sqDq3s5AIIq0Yu2sBHS4wj2VcBHhdQM78/iT4PMbeiuPDgwJ8PLlXM4rthOHKd/MrBfalYnV9JIWKiyUCJKUdDUah0uADwLN8uJzKxVS/pu0t8tJabHBAkjMpP24AZ0QnGAOP0hNbEXN/CpCi8u81VlHLXhkU/ItNOYMP3ZH2TBetBDMdcrZ+tubRgh/5NJVKJZOgcwNtOwShZ7XSShDt7DubUB+7+FQv8x2j4q2sIH81taw7S2bsFY9SsPyxqVQrbliBIoJd4hplxXrlAoz/3VxeNvuB+V5S+L8/Kmcj0yQ8HoH9dQDModw/MjLN+M2FbPLZCkewxJBNJ12uZJPidQcWc4lKM51o9NBMH/oq6cWP06LuG8PGq2wFZMPqpR84TWTA6LEEXCQQJAoAqJTiECdvVPSQJ7mxet0zSSxR45IpcgQZC/PQYzJWdruHxWyhlzamIDpoQzORpyNyNkOMXu1MxpBBJlW1mzxwE7M4bF4mcTXVutnhGspYOr1FR56xew86FISiUroS6Kl4SsYNJNqhMVVKU789Au/BtCOHbeQoElQjbhgnf7hitXML8gnUhSyEUjpWJ6vMSmbGFOTTlCSxsfbW/tgMyVnnwPXiTrq2l/aQSSfXdWAk8uhA+mVuXMBN/td6tZxgVw1qDmtF6PfpuqMjtyIUHKNXalUsidCvJ4hJJdccTTzK4uUnLIkln69sVSHixfwlcaPCoQBaUipSVzu1DrhuMfAi87vIoqiuJDzATPmGRdUDjMmt4fIxUIqmKIgACBTcROOUGpux7EIlRlvYcfI1SnTOSoPFcgBpXeBmJQq0dTsAyUtQpiao8M6SoYDK0HoeB31ySuT4qhNJ+3szBopjrOFYiKhBzG1zGlT4kCJI3aURSvb4q3bocfpyinm0aYe7tyXY7MerejPd6FOpslfQa/wWo6oWqhYXhys9XSTHMgX2oaFQX75tk8BdAc2c7KarbCSh4lGGqDhWBz0nx8loF5KK9SreuBMu2kEYk1ThS/N35TO3GNzBzp129o0AOPziA0lm9oPFcwKdYWhsWjSfV3rZELUFFVaJPksHDRoLVU15jZNt6dU4JOWufLC9Oo0YglUtjlBL8W8Of3qQTkatejdyY+21km/1X9B69i4AehXF6vcZ/AZbdQW7gIIkr00lhu7qthC4YpYp9hP1XybBNAma/BurgWtJHkOAh5maXkRrfQmnzsNZzZrzCKOJW/pwd9mIuS0sgPop0InL7rSNXY043cv6FX1+0ySPBK+QkvQbPBVjgVAJ2Ilc+Cy/aRpKsjU9VCOyPkvWC/NIM5Oayvx1dJJJFzMZMsW/YeQsV92HhK5LFhBN/DZmqnpgTSZat1IMojLIusJfGhiOzodzIFiCdy1nBCplxej3+C7DEoRAqRkqsDcfA3s67gwMc7h+BUj13wsIwsa8d0EXqTLrhOzGVbb7Dg6n8C5Xrs/kB5krP4+nwFVlt4kkjYmS9vtuw1RiUWl83ccZ2FJac2gPLp9Y53GsvZvzHaPBcgEXWtqi7DlW+wa2aBAR3j0bFHsKaYWpx4xyg0QMaPaBZHX0PM43bseQ+auyh8XqM8s9ySQpBZkRDWtzu3bnWSdKIGOVoxoDVQP0DOdnoi9KT50UhIgahjG0spsbo0S/AslePXVDS6NmORg9o9Bz0D0aF7Xa7hAVPMRX8NjvoJUAvwZX2z5Mwk32acGU7qsZCfofXYF15h3PSgl8wV6S/tPAev3V4TzoRo4LZhHVQZK6HlNBrJ2reP8ZIKmMbSwaPMYJGOE8mcjvBbw2vYe5yJUAvAfoDcy/HoaZ1SylwHeY6jm+SJ1xa2vCqm/Ro6eNwZIZWjxv+ElU7+goz+h5dZTOpPUkLJiHTzzrSk5ydw86RTsToWZzNgBLVauSQbszaSWYECVPb9JL+/Ndk4kZQM+yyIDN3eAU7DMIiPEMTUZVnGHH+yIT2rF34Hlfnoq5z4qYQ1A1s6USxwYMBvf9klKzHa0YUvk4GEaPE+zWqVZe4pJsRRWaex9hiStAI5+uTmaQhx4tOvYLMtm2NHDAIeYolXzegWwgKIVg2serr4VjSpunYfAK8fzpzIyps5sKLHmQQMYqavS73mfsHT0SQuWuBXTEl6buHkLlHJVBzgsyJLYTog3ySIiOv+GHRlSvzhnrnf9D0ISouHGoFL1vdIoNIsr17+Sh77OMxkYX/LtVaStP5NA8Lk7mVK7HgwAHkRD7Jjh38e3TjxFL+k0T+Zzqp35jIf5LI/0z79vGfJfJ/SI2gxV58JJH/Q+rY8tFE/hFO5QpvEKSdw17xP5jdOD6eiLkSzZf91eIGn6rZj0gS+e1f8Y+wa9tOLPzubuyPj+L5JFmSbKp3ca5rf+j3uSi0cGEvH0vETO5dFfROXW8n8UmsnKbCh8T7vR8hU2zIozXvYeZkcsZgJkvP1da8PHTsRDhyJZflq4xBEzw778GSSbPGL8JcxYllnjeyfh/zMFB7ESUXuM3HEjE1dGAFYOqTtZjJ/vudcY+wbPEgiJ60EqV7Eievk81dYuh8TFktGoxE3t6934zdGYeZ4kddPoTs3wZl2g3Z9Gsc6s5XlJBr1z3Kal3gsxuo68nceDKh1frgh06HkUiGbN6eGox6r8VMmdJl6v1yh46vyszejVKVOvDLsU0oFSHZ5K+Qaz6YFA4bW/X6gKlyLid7PMPgYXDN6o0DUVfA6sV2ZFriuwiLGtmzOAmLtD5aDHzQYSSS4YcRpChc4yKmBEFwHCMJkiBN3o3CjpouSdtHvUFFF5K5olCLdF1fjsJUeKSWFPoEygeiqo1DwtJw5BL2Y5mv6704LPL1AZ2fDh9SiKSxnT6EVC77S0dhQpJO0UBCQsqb9xVyJV0uXRiOqiEYZS9HplrWir1BhotlSJWrLh9QNz7budnIlKzy4AEWFXLidCSWBGnBXQdBpBJJM30s6fJrMCUIv6yhbAN61nd1eYWMRyHWrUHV2qIafWISbaoBsVhU7NyHWyFT3pDmb9K9Xo4qf63+JHLNsl3HsuXF8McCrY8WnTsQpCWVSIpsPwzB4HrWomc2bYLyZzEhScDt21Sr9+oVcrXtf96OUd5sUW8xU0PSSwG3qC4BK8iEWKnS7qModGFvPGpsS+ofb0TpHhZVbUfAbZJla3gsCTNaLTp3wFcLOpKJpPAegcElD+tq28oBk9tiwlEghfD4MTLO5d72wSBXh2E1fhv0FBN57ICfoAuwE3PTc4zCTNmjyFWambQGVb6t6HkPuTYEYlEOCQkjcZCny+S5mHEDd9D6aMFPRzKRFG4YXHKLIwylMhIpJOSsNrh/h8GgFu2heaWnmKheBJhYAFcJZmDu/Q8DbDF1GIVm9rt+R02prkQ9QM6+CcE37ly7/+xZjWf27y+8w8xIOISBOMUHGi5KxFSwFl98MPIlhYiR0LYUEOoRR6rFmFr0eDdGgyTkRHeOAh7+tqjTajHysL2Amb/HrsbEgb+Qqz8kYT6q8hRm3XPkYpe51nUu101EkIC1wz9gwtqed+cxqOADtHT5AxkfkrmTSsSow04M2j4nzQXM7MaorCTdRp2tLUqJUTk1ekCjB2+ftYMwczHRGgMBOHltVzBy2VYU23EedQITUEgci0F5FwQJt24DyraIJYNLY87cBbLtweCXZ5jxxYdk7jpSiRj1x+BdEkY5pkGkhIrNArNRM6jKeZ6NHVsbc7rqI5uUBfQSoK+BuXJWEkYSx1rqUXBcVOFUb1Q5L5RmYMnNmxgcnnGjXusAlPq6AOeHxmLO11cbBLjrSCOSZsPmlxjk2NKGZ93eoeSYV9p9G6XS7rOztrrSyyqaF+8w82CsdcPOtStgFHYOMzZjSZPfKh6FEd1feSaiaksNIvkXYuYtbBmAmfojgssyDYOz0ShoQeenI51Imvl3AE2ZvG3g4VlUVHcRXqFiG/B8xzcTeTH4NDIJR49+XwHC+7x8/hIz31YjTcWWe5CrN1Ua8TvqXIk4yL+yYnwUJt49LGK3+E1uBAn+Xo2C1gedn44MImlGRcxpVlX8DoOdqJksYVHNmkDfX1HRErhxgsy4IjdqnOabHaRYPhy5bff41wpi4u+Z3q7kxmij52vktEHgjimRNIPplTsHBnFTl6OmgRS3mEyEnUVFqYKCRi+gcItMFPPLNX8HRrWr9HiDjPD8R/6lhoW/xdSG033654P38w5e+ICcNgidH2ZEjDa1xMCZZH6LUVNWkr6/g9z77d1IcanvO1QUySPppRconNnSE4vW5Lqy2JnKX7UrqdFENcHcwPxJha/yLzTe9PAmZu55eWGJD/jpMCNitPPrVfakSBi/BjXZZ2r0ESi8H7V2TbGFXW/M468wLPoJhSTvekVI8eYMMhqKXcuNUcKWxdcxlyNLbCyqijWGv9pkFaTib+vfb/2ajyWBuw5zIkZSQGQ/Dwze943fg6oy7fXSLpReBZWECVj07K099DqKwqOWARUwil50AZm9NXMCO16E7/rwAKUbQaiy1pRrXvJAK/FpId24bR/4WEHgrkNGJMWRI1+TOUET/IpPd+OJPYdOoiKsRv0eObvw4/y7yC1ZgmXBkQdQd/s2n0GrxU+HnMhHevXS8Xs+R1UseR8UxGcIzcM/S6fVoSDykR4V4H8pnQ4VIl+oEvlClcgXqkS+UCXybzHOHwK68u/i66bVufNfIvLv8NgZnnjwDwrSovPToUbrowW0vr6Ym+Q5U5C2hfNxREwUO1BO4uD+xE2o6ja+Bm+87h1DqYQ18EcCqpzPOLNg/NkQ5Oz2a3v+wucI0qLTokOFrw/q2uaaJ0jfvZgpHIjDjP2cQRJwR3fg0gvSiKSzKf1TGT20apU09PJQZPKtvtC9uLWE/bLIxpcx1TwnMK+wHjyfPQlByfmMMwvG16mLgn0Dfdtf+AxBWp27VqtFjQ8WLP0KcHTcKvw4LgpTwwboMShdevCtUUGkEknnGkqKLDUL/XgBU5peA+u0EySMco0cmkA6rdvgfHpSzNPcGB2MnPMZZ8Yv4Byq9vMZgrQ6d3R+PqhxD8JdJ6F0L9aWZH0Th2Mi1zekKbem0RNSiKSrA/jNGVGxU9btf4RiZsBK4LdmJOvz+yrSuU3FRLmGwcidcWbBAixptxULarrBrUOo8NXijkU6AbSouNR9nJZklTAV+U1uoGJdOgkU21udFCLp+sLzjQn+rMhyDnOjvwe8lv5emuOeAcWZuYo0zQeTrMP+3/4cAgw9fwRzO5wZvwCLKrs+QlXDgzn0wMkLu0LfY0brgzuZ0wK+yB08yLQy3dDoBcyEYnB8EXnHfSdU9vMhmYiphMfA78jk8rQh5tov0e8h/urOieQmTfmDwJ3DnnDH9cLxphrylQtOwNQOD7rtwBJBU9rpESqyNf0x2y+HoXr3BuPmTXuPKR/8dCTz9UWdD+hQM31IV/SShKpXU4p0E+qQQuRfstnrBPt6oaKZHqiAQQW6lInMpWfub7cx0dWDgB1YJOklCRXWS/oSPPUh/LxpWW3Pp8sx4avV+WLk64OcL24E63RBQDAyex1BkMpj8AgLHpFOJE2TCrAIpXy/NCRm3yig9x5XuPY+K+nm6Um3c+fQpcg4byegK5/uUpnwZf4fMLjStNeKFssx4YMfqrRBGGl9MPLFTJ9WjbOBIGFweDQWOMEzUoikcbKHWlodMnk2ucO1Xhhc7bjpIdtWZsWCldZzMbedJ13JVGwiCn28ix6cdoUUcXlpiQlfdDpS6Hx8yaANwkAX7IORO+YedpFIMyQCdZN6Er+QFCJpKgHd28UsmIeZrs3gRk+SXa0CHWww14F0R4G9pUlXpw4TyNzT18iUOOLKw0m3SFHMu3d8F0z44E4qLSa0QYDOHXwlVASfagBo9IDG7RdUVR6lIfAqKUTSjMAge3a/d+uSMCEI0OYJ6b6ykU6SRgNoyKCB4mTw58kO6Erh2oQsQIWgufYIc7kOu7zePRijbKXKtfhGuu95GFM60ugwocXAHfDFKEjnjpl99QG9BOhXW29AoXy7ji6OnBxLKpE0gZ24tVtb33rF4ceYKCax/jnpnPrpYxaRRq+H3Vak02PKuQ71unbxwMjDf8F4FCS9hMzeoqH9bgAFK4zP8RV4XwiNwIwWi9yBIC2g06LV6jC1rXEuKOSCQbZ+G1BoPBPYvPPZ/2sPXuBqPBgHjv/O6alEycg91SSjud+9vUth2mtus9SGuSeLud8mlDCmi9uwkVvY361mmMuYjmZi7iPXMURREsqty3n+55w6dc7zPGfv2/v+vf/t89n3SzEBo0H3zu14MKiNDZ63MTFeFO/kY2Qd4sSMHZgJv7AdRVtIbr8Ftm1PToWj4ycg5QpLkYg4UH8DSVUbvuasergxLvM85sKZhZHPLMxoNJDoA/hqEn1I9NVgZFsNehZC/SYes1Hk1R8Y82UBRgJGTz8B1rnNYE3vY5h6EkGJ6JFwkhKBbcfC9FS2YxAFTKREe9hCcmAqOgHOyH0Ct5A4GTegMU1E1j+IyX+ITBgaLPHBJ8wH8NXgK0KYBqMWP6L6ZDlcvToPRTOnWcPI2AJKCJg7DdWdMSM0uIxB5Y5Rtbjc6zYl4tXo1F4ykybovK1l4lcYBUB7Uv+GTvtxfQjkX5IzZAi/Q+Pjo6FIIhpKacJARE+jATQ++FAiWoV6qcPnHVpOdwS1NgmJ1lOseTR2k5ZSAqXqlruIXn3MVBgZmfm8jooOI9pB5hfXMLGt2hwHNdWqIRYCVkQsoUQqOncCnGnXh9SYRanIqdSU0WEfioX7+GoopZkVhp5mlgadwz7MooQoohXDQhwdRBG0u9ZhzmFFOU5MPIIpgRI1EioewRkY8xmlvu1BSMj26+NsUIkwf811zCyznuGoRUcLPNmXQqnkCdHQvj1sm7AtFQVVaotayig8LEyjQSfRZ5YGU+Fh6PlipKHEzbaATW0MkoMyMTe2OY+mHsGMQIl74f/TD72RmFjWwRH80VGJP/jnapFY9LLhCIqFrsBUTEz0+NSJyalYUL8dmzMpo1lhiWh8AF8N5lSJPswKp0h4OCZivGtS5GXGzjFIvDMTjtjYPceafIwESu0YMboZkHwAEwc7jfxHDXTuZs/RPEFuRcXDFItHYsIEfl96HmUUrknEBzSzNEj5Yskpz6HePYDDO9O3IGOvhm7dsvZSn+/n5lFEwMT6hIBoB5Y/xtSZYc3bovNjCsqexPNv20WZaVSUXc6iRVh0MLhnV6jS/6fTP58RKSZgKmf1auTOnOGVSBb4Q3gUG4uMwF8UCfxFkcBfFAn8RZHAn9XoUKcxX/DKCPxJeS4Uxelf8MoISNQaGljb9ywKPH52PBjyK38MEf0gLY5XR8BM/+l1BRg9BLlyyyo+7zQlCGVb3mt/CgUJvVTik8+OHsGS7Q4Bjykzz36uzFl7CwU2tp+K3aq9c6EQmRE+50jW8C8RMPFRaD01Ol2Qc9jqcmGgBmVW6/1VrqeQ6bi5iijiMO/5M7jf+xoKxLdjh2dTRk2HuxIQjwKnUT5vqUQ4Hfl5NhKjogR/8qvmYolD78B/vJgZiZ6AUUPf0e5WWDSgyy9d0zNRFtoXJX5fV8LAzg6qeF1D0fvl36VMKnivq3Lyq3gUdNheGS5GVQ6zn+T2ARI9BMCmRRLK1H3HtihMd3TDQMBo1MfoPdjZ0a3GgDgkXD/jnfvEV0GB04GmZ7I7ImM/uRKsiRvmgUEmpfrP7ZqCUUdKeboCwS2HMyutO6i18O4+zFWIHK7aM/gBCkLHVH4Yf3A7tu904j7K3k9C0euTg1M/3XVrlS0GAsUih6O3OizNc7dbeaRGWgXcB9XQIGSsYpsm9d0ovkCqkQ98N/r5j8hNqbOzyVN0KthjynNjY1Br2Ym6uRbQgoiE93CS+j9GgX23Kg/6JAFenTg5A4nWrZ5O7OTPCqTsymVj88GcKrFRV3HptQgDgWKDraDn1WruWi56vbcZiZrBV+MBUSz3Aql1PU7F1n0rZw9KXGPQOx6nxZQHr1uh5+WHKScXSFPX4NED+xr5t7CvgUzTdSp8UeTRhqFJQJtNcPwJEmMrXl7VGFRIBa/HdXGPs32OA5+VO4mBgIlha8Z53xyiSV+O1DT7oRj0XYPEFv+rw84FWz1Axg9o1Ai94S0W3MGSk5RICvZilWoYRxI8h2XN5R87kbn5tMpFLLoDtNzlxNfTkGjnRyY6I8ZgrnJedp313pEz8oAxAbfPYiBQ7Fpb6N4d3Coi1yV47zkUWYX2Se95xW504VykXu9PqZGenTGxcAo7Ii/Bu0OArygVHw+MBy6OR5mPU1p3LAr+mKYHHJ8sn/sMiZqVWISS5lsclnl/uiQPcBgnLLuBgUCx+VtssCjAKkWLolrhD1un0bPh2bUYVJs2lmJv1kVnx3NQB4LXyYAblLgEPj78U3u0LNmPGdXY8ndvoexCou/ABY4HK4l7QlFw6xcUWDtkD/Nbv0AEqm51Ob6IIgLFvp00ygMLqr+VNQU9lUqFuf4sSoPePASqOrdsMjQFowePKhUkTjufD+pTgxvaNB8ynRJbP27Lv0CrzUzA3CLvW72xIP+wr+15Kxu+GYSSDb+hIH9Hhfm/hYigGjaq8bP38ikiYLQ0PmQa8OwRMu97fImBKIqYa8izjqe6d6fqWB9Xp9ra3A3hGB0LcjmrQU8bveV4DUYsvY/Ri8hl1VT8M7Fw6UfMiWLKJaC102Ixs98tzM22ml4eHvmjYK4qCVQqtQqpRpW2YNPFO9gBJt2jmECJtEagEvMrIfMhFyh2EHMr+0eh1ziGHM3C83+BUmAAAAsxSURBVAcwkUCJO6tDee2jKEokJEyv+gn/RA0YjkwFD7x7t3RSie67O2Zibl7vN+EcSkRx2Rc0ErWNKjzF3IWHw7oVujzd1q5BxEqMBEr07ggijusH7ELmBwz6nbiNueSqf5va2J7zcTsfFj7ChKDKx0Rcf1d6RGFijhA9cH23qHJY1LMlMlW98b6ESkSvYcNMzNgtfRPw6nwQuTNveCxGx/tqIQTtp9TTt/s2uPxTxvNBJzYWYiRg5LO+AjyqhOPCxFwssD2PRGHWrl17/dgVjcRup3ceUOrX+654Yabg9myWT6mDJR4JqC8+w1ylpuiotaDWQhJmyi8ezOZvIl0/n5iIzNKkLvad0Xl5mjVHMXXmDKA+lB38KyUEjCZUAFZNgrrr/DGnUlW7Alh3Xb4COVsncpcj1UX8bv43lOjZEo5RNlr4Mh1zN6fNBbQiaMWbfpjrPIQfg56dudZsciIyx4+vtGs0wZ9t035DSbD3N2cpJWDUEp1JQOF1JH7+26fH8yAkovt95NxacjQNqc8nt9r0+YWLl9Br6BlhBd9QVoc3IpG/4GxsTfQeZSy8jhnnWI6PeMb1jf3qouj5ifn+ZPyGkhbR96diQkAmZQoS4xv5bQjN94vIyUJBbziHzJIm3uVncmfrbobVo3Zt4PQmyurZY6TE/dMmN4TMub8kIWFXhejLgD0W3cCC6rEMuYYJAaN9g9AriItEJsbVv6vW4WJgCsrikEl/d8QkN5zHj6fIs58HplMmsyAMBRs2oOzJTbdRGt+K7XuJ5yirj5ut2YspAaMlN8ZUgTXzriO3r+PQKeXnzXmOsiNXUfBl/EeTqYres6fno/ehZFYsOVko8fRWc4qyuP/VPO/LjlawZyAWiHm2KOqdFYoZAaOzZ+dg0d2ICCxJCJmdj5LMmBjGq9E5dgQL7qAatxcFnhuraymj6KzOAZw8MC8vHwtyFk5FyZpGwzIwI/Afu1IHy2L4fd+rUebamDIrXL36Q35faCgKvD5IPihiRuAP6tYvTfiv+ak8UgJ/UBf776/J/yOBP6pLLvx/EviLIoG/KBJ49WZEHHmLPxuBUlVDezvv/vApSsJnbP7kIf+eALFZh8P894xYcWTAb8h08+jQHZh05Tss6blu/FqKCJSosbs5Yrd1g3NRIIqBdXtkIvday0BocJntJ7OwYMruCnP/jiVXso5lzEei8ZJDwbXW3txylbLzXyp6fTYwD3N1NjW3U4lA5LMOp7HAwzGPYgIlfJsT1Mev94W5BcidgDYDo5CyGj7ZFXjexnpoavA+lO0739gNSxo41WubHzBvG6YGf2XljTiIoIhYFLgGvt8maeEOlPWxyvq6RuhnLzH14UwPSP8N3GrZeZzGgnKcppiAkfVoCq/2CIib+SwSuZNAOaSslgfxctMhNrt3/9h9dW2UaU80Rpl1tw6BlcC66fJTNyjVZL4Vm+xb4lx7xYyuKUhUn/uRNeJb7ftuR0lYj4x3G0f1yZ+DqRoeL6/NuXYOmp5m1BZkXLw3iQi9KCFgFNqGmCN8u6fre2sfIPPw+y5MWJaNuaZB4tl+l4FrMeoFWHR8CIreHBGiEsn8pcVrlUdOoESTA05Mj1SXY2ibAOf9fimYcT7wxovvEp6GdFqueYDcgKnCQJ9IGLkyAzOzFqB3DkUTPnm4h7daPHhAMQGj+ryIgdz+J9uu7I1MQY5KVVFA4uJ3J2dRpDNrsMQFJfYdVtYAzk46dKAjw6PTMOroxPW1BeSx0PrKjJo73TFlvfWNpJCLcOByrXc2ItNvldWM5I3kWVevnYGJhYnZGESrtUnI2H/4+GfwZFMmxQSKVe1FYQbw+FDdlrXvIiciIvWiO0U6ftDpXBQWuE9iFzJu0wcDWd+OesHqNvblx0/EaBwE3EMvf+VHbi6D12Kic7sbfdOA3KP+rTciVWed1XfzKle522FzK8ydxaDWUK24Exlfpz0PoDG3MRIo9rYtP6AXXL37oLkouf4cC/y2Olx45zEWCDY8Q6rj5iroxMwDEgb4MW4ixRo4EZ9CkbQPjqnbrcXECg6loePwdwaMQcJmg1V2ENl+v/72U6v2Z1BQ155DKciMZg94DMraiJFAsTfhAgYp3d+OeokCd7tclNTf5Wa9ZZhLZa4VYEEOEt7bKsGL3Ihl6LT1Q4zHqEc5HudT7PZtl8BgSrWt83ARei1qsBGpkd7Z3e4hHkDHFQVtNpITnYtUU99LceBtk5iJkYCCtxwzUNIoEQVu+9wQnQ+2haFrkarm/jbNyIx/7eUzTLTfZQ+M2IDBTIgPRNH9HwZfw4S16sZFqJWGOxxHotNcRiVj4IiSZvE1id2PTDv1zlzoyS1KCBipWIrBkmkiClRqrXcicvUP1AGVF1xwWZWzHTN2M4ZWRafqyYyMlpjYbw/pURswcHtdTRIlNs20o4TXu/nzMFPJ9qV6e/83YuAC5lziyiVspkhXlAytxeGJyDgveLAR3FuTDFaFGAgYiRhpqZOB1K+iVvwVObe9ddiRzv3dXNjebdKOAkyFTKWIdW0RE60EEW4vxMB9z+vap+cpcbeQEi7bqmUlYCItr17PrdquO7yB25jrXfPlcBEDazV5yAQNF9N6IGP1nsOuFCq8Vf3+naGdL8/CQEBJr1NIHZgC3yNXy5lF8zPQG+XT2qYAE23ncWO27ZfsmVM/JAoTk22BzykysB6P1yVR6u4bGHlUx9yN/d3DDz709gYOPsZMvdkceIiBOtxJjEfK7VOrnJm5yNRfTJu42p5qqh8jdRRFBEqFhKNnBytQ1GUTMkd7X79WiMHtl/aYcRTyemUmkh1891gcpvxFyLyOQegkSB+PiZXRlW3y0HNbD/cwM7lLgwxRnT2m08AfCzHjWeHldAzUmwKJPYtElb2u4pR1gG01mOGYFUKxPlCvHpDzzc39qVkUESh2D7qFoxcEBSg6gYLvMKpuc68Qc8cvDGhQOOcuEtfrgm3spm3pdJ7ZxprTkZh6WNir1k107MbV5Op7mLniFdvs2JWw242Q+juPfkHPfaUvyVOR+sADzlWarhJrBqISScXoby/Dbl5jTtetQZQSKBY33qU+el37cusFciq1NpvfFVJx10sk3v2SbxciNXeVmoqtWgXdo5MIFz8+iam46e6v3QTKzR8FC65j7nQb2+daaIFcFnpDFjrwRVg2ElPnotYeBbUWOKNhA0ZBzXaBYxttAiYEij1O6l9+8ZQXtnVXV9MOeoKcqBUbJSLR2vleMkYtRaTeXFru2kBk1k1/HR1PT1Ti44PB2Zhb+MUW73vgO4qCK0eQKihApwZy6WBf56PxNreGHNYiUWegiFYEtLePPZqT+5hSqalAjyon9mJCwGhSg1ajehxs5wn7klBmh9TYD/MHf02RLW//EoGZ9LzKlbMCnyLXbWwQBnePLv4JqaR096FfUXclXG+Cuco5+eg5N+Qc5i7jfYqK7hR8NeUJUrW2eaCT89NsVdY1FPhzFFMCRhmTVjRwGaISmbEaC1rtQeJod/vV2s3o2KzocbxTPmbOr/44a+ZZFFxedJ4hDpe+ZxkKUvy+j4hAR/sUiYcUUVtlH8Lc1j5+zaHw7vDvkQtsBeRoFieizKkj2zElUCLJy//NZqozm05rUXIhpdxJpJalrHXd0CHhYOXafQcXhOUjMXIkFly+zDIsSpkUpwLEqE+xoC+puZjL9Z/XwuXHVRoseDTnzGEsqWnz80+YEij1KBbLNM1QomkROSQ4+EQ1V+iRyP+Zrx1nVOf27DVYYD+W00g9HY1FCxfyu87bYk7gP5Q9bBivwIoV/B6varxiAn9K+9W8YgJ/UfS/K8amIAtE+cgAAAAASUVORK5C">
</div>
</div>
<p>We can preprocess the data as follows:</p>
<div id="d7192935" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>i_train, i_val <span class="op">=</span> [], []</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k,v) <span class="kw">in</span> <span class="fu">group_indices</span>(y)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    _i_train, _i_val <span class="op">=</span> <span class="fu">splitobs</span>(v, at<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(i_train, _i_train<span class="op">...</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(i_val, _i_val<span class="op">...</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Xtrain, ytrain <span class="op">=</span> X[<span class="op">:</span>,<span class="op">:</span>,i_train], y_enc[<span class="op">:</span>,i_train]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Xval, yval <span class="op">=</span> X[<span class="op">:</span>,<span class="op">:</span>,i_val], y_enc[<span class="op">:</span>,i_val]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>([0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; … ;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0], Bool[0 0 … 0 0; 0 0 … 1 1; … ; 0 0 … 0 0; 0 0 … 0 0])</code></pre>
</div>
</div>
<p>Next, we define a data loader:</p>
<div id="1ba282d4" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>batchsize <span class="op">=</span> <span class="fl">128</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>train_set <span class="op">=</span> <span class="fu">DataLoader</span>((Xtrain, ytrain), batchsize<span class="op">=</span>batchsize, shuffle<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>val_set <span class="op">=</span> <span class="fu">DataLoader</span>((Xval, yval), batchsize<span class="op">=</span>batchsize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>141-element DataLoader(::Tuple{Array{Float32, 3}, OneHotMatrix{UInt32, Vector{UInt32}}}, batchsize=128)
  with first element:
  (28×28×128 Array{Float32, 3}, 10×128 OneHotMatrix(::Vector{UInt32}) with eltype Bool,)</code></pre>
</div>
</div>
<p>We can now define a model, based on how we preprocessed the data:</p>
<div id="734fcca3" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Chain</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    Flux.flatten,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Dense</span>(<span class="fl">28</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">32</span>, relu),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Dense</span>(<span class="fl">32</span>, <span class="fl">10</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    softmax</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div class="ansi-escaped-output">
<pre>Chain(
  Flux.flatten,
  Dense(784 =&gt; 32, relu),               <span class="ansi-bright-black-fg"># 25_120 parameters</span>
  Dense(32 =&gt; 10),                      <span class="ansi-bright-black-fg"># 330 parameters</span>
  NNlib.softmax,
) <span class="ansi-bright-black-fg">                  # Total: 4 arrays, </span>25_450 parameters, 99.664 KiB.</pre>
</div>
</div>
</div>
<p>Finally, what’s left to do is to define a loss function and an optimiser:</p>
<div id="509033ab" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loss</span>(y_hat, y) <span class="op">=</span> Flux.Losses.<span class="fu">crossentropy</span>(y_hat, y)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>opt_state <span class="op">=</span> Flux.<span class="fu">setup</span>(<span class="fu">Adam</span>(),model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before we start training, we define some helper functions:</p>
<div id="6d1fdd9b" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Callbacks:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">accuracy</span>(model, data<span class="op">::</span><span class="dt">DataLoader</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x,y) <span class="kw">in</span> data</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        acc <span class="op">+=</span> <span class="fu">sum</span>(<span class="fu">onecold</span>(<span class="fu">model</span>(x)) <span class="op">.==</span> <span class="fu">onecold</span>(y)) <span class="op">/</span> <span class="fu">size</span>(y,<span class="fl">2</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> acc <span class="op">/</span> <span class="fu">length</span>(data)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">avg_loss</span>(model, data<span class="op">::</span><span class="dt">DataLoader</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    _loss <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x,y) <span class="kw">in</span> data</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        _loss <span class="op">+=</span> <span class="fu">loss</span>(<span class="fu">model</span>(x), y)[<span class="fl">1</span>]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _loss <span class="op">/</span> <span class="fu">length</span>(data)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As a very last step, we set up our training logs:</p>
<div id="601de624" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final setup:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>nepochs <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>log <span class="op">=</span> []</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>acc_train, acc_val <span class="op">=</span> <span class="fu">accuracy</span>(model, train_set), <span class="fu">accuracy</span>(model, val_set)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>loss_train, loss_val <span class="op">=</span> <span class="fu">avg_loss</span>(model, train_set), <span class="fu">avg_loss</span>(model, val_set)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>epoch <span class="op">=&gt;</span> <span class="fl">0</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>acc_train <span class="op">=&gt;</span> acc_train,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>acc_val <span class="op">=&gt;</span> acc_val,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>loss_train <span class="op">=&gt;</span> loss_train,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>loss_val <span class="op">=&gt;</span> loss_val</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(log, results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below we finally train our model:</p>
<div id="fc92cb7c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training loop:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nepochs</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i, data) <span class="kw">in</span> <span class="fu">enumerate</span>(train_set)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract data:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        input, label <span class="op">=</span> data</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute loss and gradient:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        val, grads <span class="op">=</span> Flux.<span class="fu">withgradient</span>(model) <span class="cf">do</span> m</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> <span class="fu">m</span>(input)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">loss</span>(result, label)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Detect loss of Inf or NaN. Print a warning, and then skip update!</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> !<span class="fu">isfinite</span>(val)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>            <span class="pp">@warn</span> <span class="st">"loss is </span><span class="sc">$</span>val<span class="st"> on item </span><span class="sc">$</span>i<span class="st">"</span> epoch</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        Flux.<span class="fu">update!</span>(opt_state, model, grads[<span class="fl">1</span>])</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Monitor progress:</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    acc_train, acc_val <span class="op">=</span> <span class="fu">accuracy</span>(model, train_set), <span class="fu">accuracy</span>(model, val_set)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    loss_train, loss_val <span class="op">=</span> <span class="fu">avg_loss</span>(model, train_set), <span class="fu">avg_loss</span>(model, val_set)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>epoch <span class="op">=&gt;</span> epoch,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>acc_train <span class="op">=&gt;</span> acc_train,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>acc_val <span class="op">=&gt;</span> acc_val,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>loss_train <span class="op">=&gt;</span> loss_train,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>loss_val <span class="op">=&gt;</span> loss_val</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(log, results)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print progress:</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    results_df <span class="op">=</span> <span class="fu">DataFrame</span>(log)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    vals <span class="op">=</span> <span class="fu">Matrix</span>(results_df[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>,[<span class="op">:</span>loss_train,<span class="op">:</span>loss_val]])</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    plt <span class="op">=</span> UnicodePlots.<span class="fu">lineplot</span>(<span class="fl">1</span><span class="op">:</span>epoch, vals; </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>[<span class="st">"Train"</span>,<span class="st">"Validation"</span>], title<span class="op">=</span><span class="st">"Loss in epoch </span><span class="sc">$</span>epoch<span class="st">"</span>, xlim<span class="op">=</span>(<span class="fl">1</span>,nepochs))</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    UnicodePlots.<span class="fu">display</span>(plt)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-mnist" class="quarto-xref">Figure&nbsp;<span>2.2</span></a> shows the training and validation loss and accuracy over epochs. The model is overfitting, as the validation loss increases after bottoming out at around epoch 20.</p>
<div id="a2f69c8c" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> <span class="fu">DataFrame</span>(log)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> output[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>,<span class="op">:</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> <span class="pp">@animate</span> <span class="cf">for</span> epoch <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">maximum</span>(output.epoch)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    p_loss <span class="op">=</span> <span class="fu">plot</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,<span class="op">:</span>epoch], <span class="fu">Matrix</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,[<span class="op">:</span>loss_train,<span class="op">:</span>loss_val]]), </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>[<span class="st">"Train"</span> <span class="st">"Validation"</span>], title<span class="op">=</span><span class="st">"Loss"</span>, legend<span class="op">=:</span>topleft)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    p_acc <span class="op">=</span> <span class="fu">plot</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,<span class="op">:</span>epoch], <span class="fu">Matrix</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,[<span class="op">:</span>acc_train,<span class="op">:</span>acc_val]]), </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>[<span class="st">"Train"</span> <span class="st">"Validation"</span>], title<span class="op">=</span><span class="st">"Accuracy"</span>, legend<span class="op">=:</span>topleft)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(p_loss, p_acc, layout<span class="op">=</span>(<span class="fl">1</span>,<span class="fl">2</span>), dpi<span class="op">=</span><span class="fl">300</span>, margin<span class="op">=</span><span class="fl">5</span>mm, size<span class="op">=</span>(<span class="fl">800</span>,<span class="fl">400</span>))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">gif</span>(anim, <span class="fu">joinpath</span>(www_path, <span class="st">"c4_mnist.gif"</span>), fps<span class="op">=</span><span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-mnist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../www/c4_mnist.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.2: Training and validation loss and accuracy</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="pat-alt/julia-deeplearning-book" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../summary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>