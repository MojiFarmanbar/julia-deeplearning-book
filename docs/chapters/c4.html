<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Julia for Deep Learning - 2&nbsp; Chapter 4: Under the Hood: Training a Digit Classifier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../summary.html" rel="next">
<link href="../intro.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/c4.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 4: Under the Hood: Training a Digit Classifier</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Julia for Deep Learning</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/c4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 4: Under the Hood: Training a Digit Classifier</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#calculating-gradients" id="toc-calculating-gradients" class="nav-link active" data-scroll-target="#calculating-gradients"><span class="header-section-number">2.1</span> Calculating Gradients</a>
  <ul class="collapse">
  <li><a href="#using-flux.jl" id="toc-using-flux.jl" class="nav-link" data-scroll-target="#using-flux.jl"><span class="header-section-number">2.1.1</span> Using <code>Flux.jl</code></a></li>
  </ul></li>
  <li><a href="#training-a-digit-classifier" id="toc-training-a-digit-classifier" class="nav-link" data-scroll-target="#training-a-digit-classifier"><span class="header-section-number">2.2</span> Training a Digit Classifier</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 4: Under the Hood: Training a Digit Classifier</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="calculating-gradients" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="calculating-gradients"><span class="header-section-number">2.1</span> Calculating Gradients</h2>
<section id="using-flux.jl" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="using-flux.jl"><span class="header-section-number">2.1.1</span> Using <a href="https://fluxml.ai/Flux.jl/stable/models/basics/"><code>Flux.jl</code></a></h3>
<p>Taking gradients in <code>Flux.jl</code> is as simple as calling <code>gradient</code> on a function. For example, to take the gradient of <code>f(x) = x^2</code> at <code>x = 2</code>, we can do the following:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span>(x) <span class="op">=</span> <span class="fu">gradient</span>(f, x)[<span class="fl">1</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span>(<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>4.0</code></pre>
</div>
</div>
<p>Below we implement and visualise gradient descent from scratch in Julia.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>xmax <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt <span class="op">=</span> <span class="fu">plot</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">range</span>(<span class="op">-</span>xmax, xmax, length<span class="op">=</span>n), f;</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"f(x)"</span>, lw<span class="op">=</span><span class="fl">5</span>, xlim<span class="op">=</span><span class="fl">1.5</span> <span class="op">.*</span> [<span class="op">-</span>xmax, xmax], </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    xlab<span class="op">=</span><span class="st">"Parameter"</span>, ylab<span class="op">=</span><span class="st">"Loss"</span>,legend<span class="op">=</span><span class="cn">false</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>nsteps <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>lrs <span class="op">=</span> [<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.975</span>, <span class="fl">1.025</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">descend</span>(x;lr<span class="op">=</span><span class="fl">0.1</span>) <span class="op">=</span> x <span class="op">-</span> lr <span class="op">*</span> <span class="fu">df</span>(x)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="op">-</span><span class="fl">0.75</span>xmax]       </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">repeat</span>(x,<span class="fu">length</span>(lrs),<span class="fl">1</span>)                             <span class="co"># repeat x for each learning rate</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plts <span class="op">=</span> [<span class="fu">deepcopy</span>(plt) for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(lrs)]           <span class="co"># repeat plt for each learning rate</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> <span class="pp">@animate</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nsteps</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> x <span class="op">=</span> <span class="fu">hcat</span>(x, <span class="fu">zeros</span>(<span class="fu">size</span>(x,<span class="fl">1</span>)))                <span class="co"># add column of zeros to x</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i, lr) <span class="kw">in</span> <span class="fu">enumerate</span>(lrs)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        _plt <span class="op">=</span> <span class="fu">plot</span>(plts[i], title<span class="op">=</span><span class="st">"lr = </span><span class="sc">$</span>lr<span class="st">"</span>, ylims<span class="op">=</span>(<span class="fl">0</span>,<span class="fu">f</span>(xmax)), legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scatter!</span>([x[i,j]], [<span class="fu">f</span>(x[i,j])]; label<span class="op">=</span><span class="cn">nothing</span>, ms<span class="op">=</span><span class="fl">5</span>, c<span class="op">=:</span>red)    <span class="co"># plot current point</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        x[i,j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> <span class="fu">descend</span>(x[i,j]; lr<span class="op">=</span>lr)                               <span class="co"># descend</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        Δx <span class="op">=</span> x[i,j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> x[i,j]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        Δy <span class="op">=</span> <span class="fu">f</span>(x[i,j<span class="op">+</span><span class="fl">1</span>]) <span class="op">-</span> <span class="fu">f</span>(x[i,j])</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">quiver!</span>([x[i,j]],[<span class="fu">f</span>(x[i,j])],quiver<span class="op">=</span>([Δx],[<span class="fl">0</span>]),c<span class="op">=:</span>red)          <span class="co"># horizontal arrow</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">quiver!</span>([x[i,j<span class="op">+</span><span class="fl">1</span>]],[<span class="fu">f</span>(x[i,j])],quiver<span class="op">=</span>([<span class="fl">0</span>],[Δy]),c<span class="op">=:</span>red)        <span class="co"># vertical arrow</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        plts[i] <span class="op">=</span> _plt</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        plts<span class="op">...</span>, legend<span class="op">=</span><span class="cn">false</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        plot_title<span class="op">=</span><span class="st">"Step </span><span class="sc">$</span>j<span class="st">"</span>, margin <span class="op">=</span> <span class="fl">5</span>mm,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        dpi<span class="op">=</span><span class="fl">300</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">gif</span>(anim, <span class="fu">joinpath</span>(www_path, <span class="st">"c4_gd.gif"</span>), fps<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-gd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../www/c4_gd.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Gradient descent for different learning rates</figcaption>
</figure>
</div>
</section>
</section>
<section id="training-a-digit-classifier" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="training-a-digit-classifier"><span class="header-section-number">2.2</span> Training a Digit Classifier</h2>
<p>The MNIST dataset can be loaded in Julia as follows:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> MLDatasets.<span class="fu">MNIST</span>(<span class="op">:</span>train)[<span class="op">:</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y_enc <span class="op">=</span> Flux.<span class="fu">onehotbatch</span>(y, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Xtest, ytest <span class="op">=</span> MLDatasets.<span class="fu">MNIST</span>(<span class="op">:</span>test)[<span class="op">:</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ytest_enc <span class="op">=</span> <span class="fu">onehotbatch</span>(ytest, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(<span class="fu">map</span>(i <span class="op">-&gt;</span> <span class="fu">convert2image</span>(MNIST, X[<span class="op">:</span>,<span class="op">:</span>,i]), <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">60000</span>,<span class="fl">100</span>)), ncol<span class="op">=</span><span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAAAAACi5bZQAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAIABJREFUeAHswQVAVQfj8OHfhUMjKqKCXdjdDVizu7u7exZgzG6d3TEDCzs2sAu7sRVUQEBFGu75Ln1PXKZub3zvf88j8A9VAv8pVS6/qPWe/1oC/yHCZDF/t3n8oMonNo3hX0rgPyR/E8jPD7I8mMnFLJp/JYH/nC9L+EGN7Hkbzb+UgIRxjT3ZNL99PP5HNBK/V2103zHE0SuSv4npMLj4hB9jMoKoUagr1YJP+StpgwcHoFRk4/6FqCn1e9btK1ofvkAqAX01fm6EKHZgyNohWvTMrSV4o3Nj9n7U1G/TzlZ8VCcAhS7bZ05FReUhsJ0fNLgmm16gqstGExL5zEbpc5Hpxx6hkMHD2UTs0knTbfV0UgikMZ4zxIwk/TddI1WmlkMFElXYZrwXhYyrOmienc9fqvRppEy31DXTju/Y4iEK7eDWEQxbvOwl2JkRGItSPz7NR1WZNSYk8r+Big9fhUiURtcn9jKaGvaDHxjPavSMBAKpbPa7kKrYNVJV3YjO4SUMaWUxaS9y1T1tz23bGru1wANkyrWHR8UKnPE49cEHhUtfMajnyMIvbAuWFIRXMaFEPfTZgp6GxZj5ClWtLSE05MWVPe9DUGWT4xVyVl2IGbQJyrs222qBV24SCKSw2e1CqqXbkDo//OUX3rcwfohc6/XGfbbGg/mFd0hV8+BD/zs1xpUbMmRfexSOYZDDhGe1z2+DAPs6JDBH388awlGVaVjMs6HP/Pg+AwqxZBNws+PWNmBBIoFkxvtd4GlTG08HYPkELRI9D4QBnsbv+iFTY4tVs6Po9Plj7gQkxtiz+ii7Pfc05vvk/P3B4c8H0Hl9FYVcVXm3DVXjQuve4nt1n80JdxJEjqqcm2QCKYwAx0lPTIBVi2PRc6aK3wcRjFYUwjsCqUweVnNPkGBuhZcozAUy5kFJo8EUA3Kd8hsYhCEm20wYHoGaTP223CJTA7QefIcqJuyMJJFfN28ek0ggWfxRJ6AH8HHlrHj0xV0nQYeBeHZFZmz2g7/Eo/Nzb9ahpteoEih9FZl4IoYktmYExZFqfqZK4Rjk4ETQ74BN4adhWiR63FvsVrmBEcT33ME3K0T8DZKFwG0SCaTYXra1OTreE6+jZtREOIlM4dFhI8MAh8FjTV+eR2Fo/Ig8GlQsn0CVyhdIVNYzJ26z40jx0Xa73x/e2Ypf90NFF+j1mQLDBpvQdScSlex/LxJ2F6sbHTcZbeMbGVfk/iOSOUM8iQRSBHQLGoGO13XU5JmQVdN9BzKTzDe+ASr9ViDU7GQUUrdbMR+4ZFcYhdgQW1peIEFZz5zg9nEVKYZtb1+6YcEQW9Yuf4BCJnhNy2W5gKkHI9BXuBjX233AJOLurDmXnvNtSlrhQbIsPcGDRAKp6vcgHdbZEDXIOXLPJk+TtiXfVXeZ5YfMfIuJEHxkjGthliLzsesxuh3xhtr1euZEpwhprl4lQeWF96b8goxDT6DJ8pzawwvPFSlzGX0Pii5dFAoxzCnWrfMMvo2Rhmokq12eFAIpKhw15n5gHQx47u2s2VxlCFIzPVdNys3L1auf5CQXMtGuXjXvvrqJTpOLyNz7YG+3+wnUFDHkmnOPX4/fQip/Vsiw1iGu1w5L5NbOekaSjV1NUaWNQ+bWs2INe20iQZHNcMKXRALJjKYYw+LKdTAgurXZok4Dq1ZA4ni/DoWWXj0QDcU5hVzcmTMk8UHuXev99nZ2pNpICtPMASSJ3zi9+i2k3gRnYYlD9MAdgAYJ4ysiyc5+bDMVNW+vIbdhZK45AccAJ48MUCSARALJhOYw3WMuBn2id72sdshs3kySRnzCsNsoXN06njT1H5JiatF2JKua7QoyfpeaUZnH28EIUURPpmMei0jx6jMqsliGo7BIOzvroYs+5GpqCZiSRCDZQDgzq4QVhGNA6UVZ+Tu5Wg8mhdu5OFI0nkGyMsuuP0Sul68tlLl/g8J4X0FPgaqmm0NIlm8FKuytw1FaEtOjUu3aQPj+JrafSSKQTIAbju4WsAlV5pNr1+LNcH5M1RcoxIza0nK4FRCwcfvTeFIdXFbM4ynYFW7Z53afSORCik1snZciRSDyF/Tdu1plZSeSFLa+iYoHgaj5dX3hQm3t8469+/Kp7XGSCKTpUbsaPI1BIfuKDFhXh7dTPfkxvqiI8/GZgtIvHwe73z9YKl+5Kz9vikUpaMzEal1M6uQ56HoPfbEz97bP1vs1OhlOvrqMigo5VqMm5v79gyRpMI5EAmns7SG6UwQKWxqg8/7S1McYFvkew0L4dvGr1toXLB2+/PR7DIg9dw4VR93cXe4+9wyMzNY/smEIKsoJYfwJW5IIJPMckQuIG3oLJXt0Alr4kJ4wX+N4VG0eRrYXfId4f/9z/IB5p3c5li0Lcaf7+6OmLN9MINmzhvMb8XT6TlQMPJnhcM+4MNIjZjy66Ayq7u3oPLo9/w63XJo4Z8p7bdltftCbd/4kEUjxqCmGXMnInxp4Ju4M6uK7CwL/Hu/WrSMdQ4eSvrqkEPib3MuOYZ35/47AP1QJ/EOVwD9UCfxDlYBMzbafz715yv95AlLtNljDorFI5Rg2gckrwvgvkn33sHv83ayrtM3/kzhnEiCgb2+ugtaoWP+TyMytYfwXWVV7vyPpKX/Jr3gM38FhsF0fAYJiQ9ERSJOjQnUHztiXRG5wbXjiuGhSsVv+fJ/RU+bOJdHoJ0fRV/ZTH5MmJdAs/7Qk/jP6Ri3cPvU1f8LeEWNUmU4QXIGMg0wLCDHocyzRhrZm0R6ee1HhcLz0w0VcDrgXTgKBVFZrG8POgQW37LmIRON5FtGuuzu7Vsjf9TfU5eo4NK8YsugXJCzXdBZd7x8FLNd0jnC6iZ5i2yHwWU7zIUx+XCmCNIKL2KVKq1AShESjzsGzBHm67ECpzvxyN13B9khVLsWQSqjQtqeFBRpRNO3c/tNpFIS5pS+NvkYqgRRWORqj3TXs650W/nFIPAjJOWc+c+6siPmKKofl9TJc2IVtDiQyLO4Epu2PQobFnfjNF30XjjXymX7M2alRRU3RsdNJY5kdCt0DjQinzy+IRk27CmBkhpLxnflv3oDR0qqc/DmOVHNHaiIfHuGd16m8mBQ5jcKArgc6xpJGIMWMkfCuK/AamdcfczoCwRkeHkZNt/nZLo24He/4FKmSPYHo3UDJnuD+FX1vf1lwFry93evOLYe+L95FMpCsfv2sE6JRsh+AAb0slgO2yzrj0TWGNNV51eYWUCJ7UEQ+lCotjHKNRY9AstJ1MWjaoarA4CzrUdNuQ1D33bHUPTx+BUo3jwHNUbpMkmBkJuy1G+9EsmErnqHgsLdY6Nw5qGl1AtAs6Rx1oE8MEp8fohPl3WVHvlcotDeZ8qSR9Y0XpBBIYlShFIR2RtXLdxlL3Svb/PcpqCi56n3dZ2C2zeQ2MhqMtBqg3XgwwoBm5biChA8+SzI1EEjg5Y+Cw97qId3ezfE/iFK5pcCIrrHdPZD4rUrZAyOewvMmAxrdPY1cxVFxnWZBQNuLJBNIYr4BXve+gKoHz2udbHAy40wtKjplnvoMLH+z97mAVPDbXFrRNpcfU0VY8wE1xsPcWPU7Mh+7UtoI1+bwMRKFrtXxPF6GrDU9UXjlS6aBM3l+E6m1JvN/OtfjFGR1FadFI5NzipFRvodnylRcVoFkAkkmAte80KnbnZM7keo7auDJLMevo8ae29Ro2DVP7GxkfHePgcJ7RzsVAmbHo2bAQvHWUFTcxTILcA+F35rhMYqvQVntUHqa7ZNnTc67vkAqauH13dmOvKwUMyL7xXvImC9szoWRN2FDj+qXSCKQpD6EDsJk0HisMtJa2K5F37PZ7ewpV/E8Ki72PBVpJ8LZA8i5F20Klc5rRNjyGhV56lYndgDqMtYAjiLXt7nFpxmfeX62LSost+cyj/TorUXhXNPB7Qodtirn1/wTMtXb8+vEr+gYZSSZQCptCP2XkMBqc9QeJPz29cd+186loj9yG8UaXI9cYdoDhYinpLiHGpf1cP4m6qqjpuEy8yvD7pEgb7lbyD1pAw96oOZGn8V3aolhdT4hV+LTnPkiUgKpplcf1ZBkI/YgYVed+Lgso0fH/3rVIxapTZtgpNXC9yiN1fS1BiMtBmiAJqgzm6iBeC1SWSaZ75v/tAx0rsHPTs7IFB8Id3tggO+NSmhQ2nn+NnICqWYYWwHPC6LTEqmMJVk5qtC4vsbDhk1q6I+cSU9WombM6dF10IpE+KKi5VIOzYpDXZPyIpy8i4Ttoeq86lamJvhHsWwsUkLdvdZc7voSdeZTK4RaWXeZjlyWvmOikRFIZUOCU4PgxtlPKEzj2eCxwqzitY7P2o3M7FKH3qLqhN/vWSBs1DGUrOpY43kDA1yBqH1IDa8OY+C97/qz1g+LIeM2iajwzC8xoNZESrZYPP7wLSSMuk+bGk2i6jE+JBOQGQScHYtS4RvEhzHYpsuKqbuRchwTOFiLuphI4P5mlIynDmH9EQwpJYLPJqT6AYH3dx4NgKKUtwpHIj+hA9+sN41BVfl5n3u/WzWyUPFbSPRYPXwHidoXfBxEMoEkD6uQosuBeOT8F40+3OoqOl8CUVgnTv6AAVlyAYdR0fYnXrh9xIBx6LxFptHhRwd3fSJBfLR9t9XoM3f6UuIDuStfQJVr/mbn0QlGwnLJ+y0kshwozCSFQJKBVu1JFLLqXhQKUZNydvDY45oxyyzsCUCqW/XDOzBIg9Hj3Sg12GYcveA9hkwFvixB5m5eUjzd2avxavRpbBZ9gOtdL6CmUbOz5wGNBpmgAldPBG75SK5lzhc8SCGQJHboGpsDcHJe5BXUxC4I7zmyuGN+iHbbhESGAca/RGKQiPb2axQquxvH/LaGdB31IR0ze1QzjkdP5OFtwJ0sqBO9AWuz14+QiKjcZ8A4JkdhlSFkiJYUAsk+emFEOm72u1GuLzDt/iGkBlXfe5V0ZckQhozTprzaYetJ30HS83JL7wPNkVhTz7So3SYM6HHsuv36XA1eIxUyf2mFGm0rw+nJ90gl8M1WMwAV2dqLK0hftCky2VbnZeN6/po+fZDybXflZeVV/qi6vL3rhZsFswQ+QyHm8uUFyAj8VU3Lbb9Eus52+oqMmTmrRpOeha6nTx/k+7i7Y9inEZoulTXXB77mmwj8ZV8PxmPYZQEVb/PzJ9zd+Zt96t6dbyfwV23cyP8igX+oEviHKoF/qBL4F6vU3/7L8GD+vyPw1y03v1QkC+wK5+EX5Hr1iLGoeWxoPH+feodGreVfoWHDhrR+SCKBv0zonqEPOn3g5R63aKQub7reetUAi36x/F3y7TabfeoVZHOqVfLCNKRE0IiABgOqlu9bbv2UABRqTBCdMsAVGxIJfDNj4xh0ymxesxp9QzPAuydA1pL5J7R1RGob7H/9R/frK/m7jM1IxpwRBSdXy6i99gUpERDRETWoKF5odK1ndmIf7QBkbFu3qy+y5dq0zCXvk0BAYez8CfNQMtnsUskfaq/PdwB9OWfBjcZBgJU9o8xQcWPxtK67gklhZEWH/BsD4WSp7dnCq9d9jVS5pnX+GJADNCJh0xciN0iEsxqRTyuPnkJKJF1tppl5bjqeuZXDfOQc16A91C1yQPbw+yQSSNKsA29uRUPJKo2MI++iZDqj03N/EFwLbQtAT/YVFlzuHoRO+HOGomphxyq9FpAiux8wEdCI/YG5HZHY1sGY2ogggvW86BVIdSLJrwtf8302dZszPQaLjWIz5FrO58PAw5iUYBNJBJJ8sslZs5llfs4iRLY/gYKZ+ziGgjDX5eVG9Lm0gAnPSV/Y6cJlMaRStkD0bOukQY8RMpM1t0aX3BWCCpE0ogYZx7YH5sWAsPAqCi0L+E85DGXqvd5PEoEk58+bGGs1poR3djp6FKWe4zl2GvqNYvxZ9JiNhrCP/Jk/htgYaVGXr8d89Ng/zG8J+4KABgVQEsUT587xA/pbrfoC5Jh4YxJyL8L7nwCTXwpvO0sSgRSxsRCN9RQWo1RwCS96aak2jzlH0Fe/Ilhd4cCBK4Gkq6l5BMliLhSNtP5yRBjw+n0VdIqgr6VgbgQfY4HdBVCoUZjT/JB2wXchV4Op8YNRmD4dna11X44nmYDUiMJTfVDIstKMU46OrRtYPV0Sjb5SgJENPXq8W/9wDwbZsSuSFMFORaOsvrzNsfN1QGV3Z2TC+UySYo0hdDNSJsYYIqJP1CC1d8ztODJmPNYtFHVtm8RMCySZgETpQR7zYtEpFveUNHMawMCBQPTYQCSWVswLT+Nq584xjW4rTiJhbEyclgQtiBNJ8xidd+/gwkcgv3kUakwsQfsFhRYFNmGYRkTdtMim+T7kiXYPRV3zzRZzd5JCIFU5Yxic41MZagSWq/l0IXpsSTb3MFIRbUiQtWvrqsZNCtXzR0/DOaU50c8fyFQmagkGOWf6gJohwCNkIgJyjGA9v6x9iwEaRNRETpuWo/bOEdcxwN0ybAapBJLNq1TTGJ2+fQny9xp9BX29T9ULOevqyKzpqAtavDjn2O5F+rmRxmlP2MJMPU+OPAOHc865iZpMjsCuINRkLAVBbZG5VnkhZs2Y1Pdya75bsZlHt6Iq7zLK3OkZSSqBZB4bKF+oQY0Dhx9+Dg1E5vOaNfR21GybimH+oxwbN5sVS4rSv/jWjOLLyF+7XmtSngOoyloGiIxHzbwq8CQIOf+OGGUpOblGs5st36BKxADzRZqxUaiKKZsrbNsd0ggkuwZPqPJhwEdU2fV25+V4/kQ5k1iSadwKN4qCMaYD9mwbbdb5Juo0gAY1NqXhakfUaIO8vJxWll7chu+zulSHJ6iy+iUXnovQI6CnY719H1FXeA78/gGpwh2dv+4/HkASY3NNpEiKYi3n+KAzLGziZKbvQp21CHxFhU37yrDyPYacdd3dotQ9lESSaJBr0+HIEdQdrwFBmUOBCm8DSSCgp7LpVdRlWQdbBiBzJhc0Pe9Eku11xP2RpMiEDQmy5oV5M1AnTEJnOSoqrgH/sxh2X0Pte3wHU1ej6ZGoWl8F6L0xtH2TwsUKk0hAj0XADtQVKsarn7XI+OaCi0MLvdAW1NBlaGZeTSfV1bX9Miy4l3FU3xyQPR51WVsDlz+gZN0Dopf4YVDu/SIHkdCIpNEgN7XkrE+oyTS9m/Cmzf4856Ozcqd7IIkE0pi23BKMKtutfB38AbnWcwZS4w4X4pw06Pg19CVV/JCYoZ1ijcyi9mxc4pI5FMMWfUWpWVe4ugi5Ek03hcSZ2+SYXNs0w5dG/nyHPMODY356hooTlXiTn50/28D15oEkEUjTOftHVJkucfza4QQKX4Ys3F4FaqKjfbBr7zP0xI8517rj1v0v7tNosoZ0vEDFKIidjcLnbrNOheWqAhrx9z5+yGhEDJuSgcFlUNGkAhvmwKSYsvx6J5BkAmnKE4equl3DFxxHhfi8dnnrDoB2U7wPMrEeHp1J8Lo/36tMHrh8CgW/xotbaES4f2i3bxwKGpEkGuRydoIFgagI+bp5yWvADX0CerT7UGO1igPTURd7ld/5S/xCUCqSFeag4k0b0qMRSaBBwc2KM6tQczkzKgTS1Lr6FjWmeS725l8i/FEx7r1BaQKIWn6ABgP69eO7CKTJsRVVoUb8i3ypP6T6KFR0PhM18zT/SQJpsvNv934Kqp7k5j9M4B+qBP6hSuDbXbk6gv8zBL7d5YFrHvJ/hYBU7j9iy8agbtGI7A/5v0JA6khBhBjUteQHPLKoFMQPyNJpSvaNQ6L4blY7mxV/nCvXjVj+EgEJo7zsjcKAq3y/cnlmBfEjTpRH23P5bb5biaaiSC+30w1RyNqrdI7brmEYkHdU2xzcrhpDAgGJLjYc1mJADb6bxVaLAKCL7ao4JCba43siJtQ8GPIZdWj6vDsSRpNLHTVp8C6I9JgZUzdnxK4Y9DlMwvs9UAA5s+FjTL9S9LfrqLKf2c76yXPbslXPkUBAJvgi38PYdQq/P9j8pVn+iBXvUChWIv44sNJm3zskOpcAwh7bPRRpZAyhSBV5VfHFZTb6Y0juMjRqlgtCb7gVQE/OYyXjWoahwdg0BqkzNbz7vsDaCFX11msXLIuIbbk/L4kE9Bn34d5LvofdZJE6dYZpRBhQzRcZ82kMekeCdkuRmfCiIXT4AJuzNucAUo8e0bnkp5Wocm6WtbGpNbxa/+j3V+EZ0beo5Jc1YSCSrehdJIbW2D71NXzN9gUl0wX9fLq/BPOZAftJJKCvYm3WYFAplIInFCZz692azG8qlqnpi0ydFuJFIIfAXqQulfDbvx9GRAJ1mp/ZglyGMUQEQuuYoyJSwvSaxN+4+OXg60/ohJBG2NuMjRMBK97fRSLrnPfjAoDCZ4fuQ2F9lwNt0RlY7EY4iQS+XbHwl8jFLQAj8yiM4pp41t2ITBdx9TOggeWrcKTm92h75CtEAhk3MCMOucNlmQnt5uUxj0VqeE2C5y5Azd7mrB2HTkfkHC2XBKBjmr3PPuTcuu3rhE6zRfxMEgF9ZqQnLDoQNdoI0OLDe2RsnWJOxOJQeCT5WmxF4nlcq/lXSTQrz4qryNWtxskNUD4PcpknEdzgFiqsL5Tk8EzTfJArE3JOvCNBV64gV7z380GxQOfF4uPfSSKgrx9hVzDofBEjDCvMXmQqOGh2viGTPTz/iJw2nkSV+l4dG4tM3hXCy+FxmFUmBimjBTFcvo2aSaUgYknBMoBG1CB1nzJCHJhax59ArnlO1yCw2dTc6PQkkgnoMc3P7dcY1PjQVwxrqo1H5nT/weWKkmD4caRamZ3wIYH1jpAZscg0W1QAt2cw2pm5sUg0vz1yb9NRi1BqOwHoQCKRQ0hdCOgX4+1Ze2Ab8l1DJgyhVM7WXc3FC+2/kExAj111ZmKQjQPpqD3qhA9yG7aUbetB/t3vLyGVZ/TJeSSaU3DKcWTyzC3A9SdFH2frD3uRKNdnWNiknAt7zNuBXAsg9uq94IP80oBVE5EKrbdnyJCvlkZEHkBuXe9pU0kw/QspBPT0hesYVDnPMwwrHD8PpTgfHyjPis9IvWkcriVBnp4P1iGlybqxCFTy0kQLVpx/jMTIgf7crNJj8baK42ORWpzn7YF9JMjLkzlxyDyo1LoCjywWE4tcTONaLsdOe/7U5XdSCejpwPMYVFi2s+TBpfIRxzCs56fzqCs4lQPIhZEo4yGreR+RMnlPAgvMIWZbPPq6WPoDEavubhnhuwqpm04kqVaAPX4oRGzfDs1RE+DhwYD6+w6QRiBNz2Jv60agZO9dKNzM9KrtoWcYVLioKwa45OQ9BvQse9sTmZJPisRte+ZVpXT5Mvy+AYleriS6WEg7YhXqhB0mePG9Si9/PSKKNAJp+mrev0FFf5v+Gws3H293FMMGRW7AgLycjcCALqL3F2Rujuq26Xe4avmGiAVIxY25HQ4FbEqN5xQGWOUTl17EgHgQ4lCy8ozt7Y8egVR29iJqHMa4bsR3QaH+DbIHYICN84Io1OXoFX8gFnVNyr8eh8LJkyQYkZnd3kgNu3jzeNbi+W344jkNAzqLXIrDgKP7W7feg9LY3L95o08gVckCVB69CIVpNheBah3flljTEgM6Wu/EgF45Hi3DgCYabRwGlJ7Ch+XIPK3VfO6n074w4z4GmPXRiPZCHAa8osIeFGqNvtcVCYEU5lsBW5QGDULncibSsWZsEOo0jtzBkMLsxpD65u/qP0buyYIV2mjSU6KcyFLPNxhwdHRj9whkbDdq2yElkMI4F9ydyQ/p+NULA0y6cxADjIz5AwOKj6TZY5TESP6UtpUfhnj5VGy6BynjdQV/foqUQIpwI37YlKM3MUD7+NFeDChRm1/OoM7R2OkeP+LJ4WbTjmDYrYoFkOnbkmPICPwNbDLOxJC44qRnBgYcOsSPCW9JumbVRy4zJ58gI/A3cI6+z494cvnJYf7d3hRAbs4cFAT+DjP4ITE1+a8l8Dfw5H+PwD9UCfwdJs0as4j/LQJ/TYNT6Ihat4tX+Z8iIFOqacHeQTOX840+kKAJlsWu8l/A7GK589Ofvo/jxzTz9G36lEQCUgMWmyHajVuOunO1Amr7oucuOo0qEhvCv0atnTmuO0UjYzIoB9gMErdO9kdf+bJirVMMWYOqXKXtKxcqe95n61tUVd2kLXRs74xIdAQkNrY0Q8f+cVFU2GSros2Y3Re5QgK3PVFXclhb24FrkCvk0IEcBUsd9Lz+LBpV2Zw6Dgxi7FxRrNjgMFKms0eio6Vb5UrhpLEcQ4Kp2aejULR585IZ0Ig0b9GlZghqbDJDgaqWkegI6DFp2lME7xJZje1RUbz9VGLO+aHQFXagbnkvS8Qha5AqUX+6lQiIzZvj0/UZShXdqmXU3Fy3p9B0cUiWBoeRMJk9kgTP44oUMQ0nTZaWJLCf0rjVeyRqNBxoq4k4fJFnDxu2rpk1BBWltwDxm4JJIKBnzCx43+/cwTqochoMAT+h0KIMcc9QVbSHpc/8IiHItJ1KkBi5GU1zR8uKN6cuRa7KofDbOLtbuJ4FzVRkho4kwdVW9t426Juq4ai2ynu73JXWtI4jTa3F5cU/PC74f0LnSVhNVFjPbpINiN1GIoFUFu4dIaDNVXTeorS0tyWqfha4dgI1dr+Z9d2sNbLYc3Ep+l7v9PQggXvx+gMLj9r0BZmjwaOOEf98zVugJPeR6D8RnQNnPD4G+FZET44+YnDfwCyOIWP6NC53nTRNbQbtDSGZ41BtPAqN+rZEn0CqSmPgcY/rWFkRNxsFu3qWENsfhWblYDqqRhYfsRG0+duWXh+Ons2bSfbwYezyXGbIxdTxx3bNLH+gXuNza9BXamYWeDVvfTxUL42+DjAgkOBgJv2Uq/110qxaFECKpitz73qGnFWfliQynzuBBAIpJg4EigPVqhCwE4XmjsAcLxQmG8Np1Fg0ub3wNc9iAAAgAElEQVQanfp8iUOdMHu00ac4ZEqN9ieb7WB0Mi42e4o+44NZQFyzBjCaZKpF6gMJgvsdr4CeV6Qa7256ZxwKM1sR2nFbNsCcRALJig7OyeepGFR/tDGcPR6LXItKMNu2+mj2bo5EKlOZwPqfKN6mofZiNKqcJ7uI2sGhyPQ8BcUD0bF9mtFvOHrMeucDZs5Dp1ojloWSRqOJiSFRSKwTKrK0bVtbuN3KH7lSzWDPmWh0qtp/QEcgSYlJOflS7yYGWRUDZl1FYbQI9X8WoXbrxrFIhD8uepIEoaNQkbFHi+omsRd+uYBcwQUnSWDqNshGnBmNHpcVQIw3Olm24uOGHlG8cZNEN25WyfEOmRxDatXUiDhokCtxMjulntN9dMHiVMz6AR2BJP06EdzgFok0GiMU/IDAWygUdgQqkMBl/CwkvtTbXI8Ec1ExclROjcil+ij5FITrcUOa53GEhZvRk6EXOvO8AePx+bgUhiEdFiNhOXWCiOgflj/74tZICYOzx69/Hs25c2PnEhFHAoFEywaJHLpFoqqi6Iqc0RRgRQgKA7KRqiQy7xp1yXTN703kUVRMtEOn0m+dUMpRP3RSCyMtT5edv4e+GW2BkJXo9BvLnqlIrSfVTSSqry0GX8bu/trk12blbyIxYiBrhpFs4yMSCCQo2sWIjcNI0gxikBvYDN5uQqkoCS6It4aBH3LxW6Ebzx+gYpJ5x3clsmZtb941HKlq/TIdB1Hrffz0HSRsqqNzMxCY3yP815lf0afRfCWJmZnmLPraLctGzLKl/nB07O78N9HXegYcIoGJI/eekEggwbBMBC2LIlH9krzwROaGI7DhHUrPgdcbZ1VeDuxATRu8ULORX6HY8VzNK55FX0+3bKYQ8fTQqk+xyGSrAGhnAfNHxjc/hZQokqxJWRF9MyeLsWcn3CLB3j2V9qFvtBl/3EPHZGLfsF/2kEhAJ18PGHSPJOPNWfIZGTsreLYZFXsHw0bfmznsYMMTVOSs+mUPBj0aeIQOZ9GTe44dcKf/DZQsf4NYkznncDyRj2mnUOjgQYLsq/FFX0Dc8dmXSdJLfIa+epXxbhYFVOvZl8q+JBHQ6WTBxd9JlL1VVfBHpngGCG75FhU+NyrgjkaEjSMjUeGQ7fBFDMsCu9HXz+6656F7o2+gwrw8j9Ys0RYb0jgvh+Yid5Mm5W8CFZrZchR9y48/I1n52TxET9HdxhyLgmqjnLOw4RXJBHSCtUYFKt+KCYNinSYT4XoVmW4mcPYLaiLn7yLBy/HHolHTFT8MsxhF6Dv03Yy8OptPqGoObz7SZgp8Odxfi9zZ87V2zjhHxykZxEhvJJ6RrNfsrDuuo8csE3QsA23M0S7fHkMyAZ21JQY5nLz12Q+6a4k6vAiZcm0teXbGH1UH1wxgQdzp6xGos+EMhs0px56n6Du4YNBB78ktzqKiKNj2ohjcm3IEFdNPFdqiEUEM63UUFSZF5jXk2fhYZMqXR+f61l9JJZBgxE8FjcqRICZ62Dbk2hVAu3sN6uKGDCE9rUURNc7Zd5NxZRuRWUi53z3ok6HUrGBUVQKit/z8CTUX262xRefioAeoKDFokEY8MuQ9am4uORNAGoFERfvbYjcKJvmcRlXcNH5MJYsnB1EzraBXR9eMPG7tj8wBo5mFRSNUrB2Hjk+HV6iLPpC7pRO7jh0OQ8GmW81mFpycfiMGCb/+3bPfPg07I9EnkGQtMBYDrsIyflAzk5Ooy/kOjfh7Hz8U9nkFoerD2v7Qf2ckBi1bhlK7lWhEExuNGDJlUwwywRs2oELgGxwy5oeVxYDem2oR2tE7DhUhxqiKGDSIH7B3L99N4F+sOQa8cuG/mcA/VAn8Q5XAP1QJ/EOVwP8dB5stW+XLNxL4/4C5Noa/blozcVjcOl/U2e4v576INAISWbIUrefQBs09l2C+Q7WSNdpYMa5+g+3d+RtZm2D1UyYX6gXnRMZyR8tlI1BRaLJtzIoXb1GyAUa1Logquz21MEWPgJ6yI2oUBESuf7AJ5lvlbTwup6ARReYhFkBO4+hrXrSXafdL9fk+2Su1aWxHkkzIFW+u7ToCBctRvQpAm5CQrteQ2zYKyIuqvpPyIiWQpsYxa4iLWL/7Y2AEKdoUXx1EknyNq+dbtB+pBu06WkLc25PUL4iS/aaae8qVxc+34vBlfIefxtQ2QSOS4M11V+SmggalkTOAY6HtbI819EHmDglaHELBYV1tq7tfaqJPIE1za7RL5wUicXvT2C2v7oZBxcIt8sAupAquy8W7Vb6vr8Pugih03GRGr+stz8Rb+uQhRfG8wIAK/XF/1wyMtNDkBBJZ+k8xJ9GrSI9D92ORy50LRBTazICQn26K1zO77i0dhozxts5Q+xAyOdr1K/Zl/+DBNdEnkCpnH3D9BZnnrSc3zG8MRB3d5OXquBOpdbmYNe8rKU4jYb/MjNCVblroYrWLZMW3lwIjLZ4YldMCWhCRMFnZDu7F+V+7GPAqEjXlykIAco5zNZE0uQHLjEq17rwGuf6rd+RytIhE6nRRXkzeQwEkBFINysz+uSicOUMFYyD8AUVdzoUg9dyJR19JUNkRDs9An8MJO8KaXkan7FgfktnlgXdG9nz6aG0f+xpre+SGt4Oxy+MwrC0wDblxBc49bnMVHe2G1m3WIBd592muJrb+SGX0v9X9MyYWSAikqkbkrHjU3CBJRfYhM78302M9gM7LMnNwkBZ9s0uLdLxMgoNfSXFuQA3WafpyYX/xvsGzaOSJjNNMGLc8DsOmdoZ5h5Cz454RSR6EOaNU0oWweGRykaBQGyQE9AT4k67OwWeReTp3TIGd9X97sLaZBo9hgeib3FVk+RnAdFjLai9rfSDZvn3AaODhaNTUNGXB0njSYaqBVbHIFG8esaIuSd5ccyn+ELnmsP4DqgJvlUOfQKrVTvkW9Y/EMMe6v99FRpz0dmamvj2D7UXuDA9En/1QIz6PAIcq46rdjytY9gSqjmlZdhJ91aBPDt7l4ODFD3yH8kYHnmQ8QxKfuuUeIjW6VHcYi7rgB+U16BFItbf8+M4Fq2NYI5O7KK06MquLkB248AmJ6tnBbLhR/0z2sb33P375B+q02qD9SFxrjG0XdLqKp3u9Q8nSERb7I5eFt9zohQGNVucSRWh3JBJ1oogegTRTijeteKjPRwz5KXoBKuo6a0ADQ6sMu4aewoD5EiIernFnkb1XDKrWw6PzSHh1KiCQSKz3pN0JFLK249O6eOSaAfHxqMqyvJ4tCXZtXHqfbyCQJn64Y5Gmc4ZGoc6msMdHlOYPMxHfTrjYe2D2iu2voWdJq/yNu1hz7ABkqMd+1NlDf6TOF6tQuViW7A9b2plhuaFkKDLFe8G+Jyh41cmNIXXak6xX895336KmeCsShJ1BR0DP64YnivQ6swt12QtdQUHzy3Ahbt+Et0y/fgSpqLAYHx8SHS158ACqWlRAwb6k5a5QsgQPL/5bSeztQ5EpMZqgDSi95qcMYSSrpL2JuiyHaHMIqco2WRvRpauITtSlWd4goO9No9MFm+1CXTvxIwoNx/PiZw+g8ha+HEHqGUnyVmCWFjWO+zF6GIFEh9U2PO17IRgeDj6Huj+uonQ8wq6Op0iiKrW0T9Gj0YCRlqO+FWsBB281eU+KHLnKt6mUgQQBrwHHOk6T5yMg8fZuwboYYBt/AIVxsNkDyLMnCxO8kQjzJclPFm63UKeF1e+RcLUBR48dEVC1MkRFIaeBkagIbnDhQJGnJIrRBuR8TRpRBK0Y/MsV6y4rQVt6XVNSnC6Kjt+7ufDiLlClyAQHEJBo0IpjGNB89zkUzAjaBMbtl2cWl29EalAxEuWZfW2VFkPObkfqRhEg60hAI8IvL5Fz5FUsat68KODaJxod0/Xms18jF9zrCl89bvftBZ9IVdxfyyo/77cku3p1KyCgx27icJ5OQ13RHB9Rs+0dDcfU0XwZtg2ZDx9ItCHzlCAMiviM1KB31WqQzG/pchTGsjEUNX6tb3c+sA+w21wu5Az6ImNM8et/EggOvmfa9fgIUg1dF4OSQLKRDQ9na1mS6E5+qBts+QE1Xazq5hP43PIsBtSrE3AZA9zBFZmvE4xsBk+wBlYvexOB0h8tMeDpyZ92lPci97iiwY2eo+9I736Hl5Akoset9V9JtRI1AsmM6tcHHg24hQFZgjahFEH2AfBl73Q/DMmnWRqOuuK1jbiBgvbTLws1QBSqdrXEgMg2M4b+/DPwpp0PUrt2kWYJf0og2ZZyneNWP9sZjAFWjc8EoNT3j3y82rf6BelxfmC1Pwal4tuza1EXjWEaDIoYs79PFfHab1fC+IsEkgV360Z6ame8j4rXBfkzj+43yDhLREXeUvyIPXsw7OJF/hYC3+hdND/oYmkMeH23NP+tBL7RHQv+dg+7nnTgv5TAf9KjPPy3EviHKoF/qBL4X5O7SeP3GnuPrfw1AqmcvLWvG/qiytkZJ2dvd2++my3EfeHfJkvHZSJoxNI37/OXCKRqphXzdJ2GCjcnZ3ScndFggMPGBh08kKvZnR4CAc19+LtZjm1jsnIlGIta9A10B44GvStc/j6G5cjKHdInkCJ7B6DbNJS8nEnh5oa6mfVF5ByW1bZDJ/vBVtdRkfHFnTokKPEqnO9i2mWmg/iuAAjuSwPRs6oHrJv1Pp70WMzskvVhKdInkCKrA5CpuSeQKQOB0aRyBrw5C664enujpndPETkT19YkcZjZPBqllRkdbEOAQnfrnOW7tF6P78x9kWRfUmY+egb2532LG/yJ8aNE5qOQoX2NtudbR5NEIFm+vehsre00/XOm0+Wnr32PHm93b3S8vXD2Rk0BlFb1Qme0d5NBOeqNmoNCvzY8DwFMp9HzLEpDp658iYtVtaxYINORhW4RUOp3iyqf0NNHDC4fyJ9o46phyFakhIZtGmYXadh2B0kEkjkUxkjLUIxGHmpx1hh9Ls5uJPLGgN6jIeo5Un20wNbl2ju3jlBvnha51eLjgei060wIStbLRTcSfUWmZf29U2JwadspuNor9BQuL64JxKAKyzPN3kaJhSIXtiPVYkwNwN/WwmUHSQRSiGhFQCs292+OhLc36cs70UzD11tInasMfNLCw9d5XSb+gkwnaO0HWIwidDVKF0RC7xF8mdATyOSzuByTaWUndo57j74D3JyJQVadqordt7E3N9Gzwkjj0LZGHVsjkQ+LV80YcYdkAsmGkUrI8BVVzqhyXllARBSRcSLZ64FHjH9eEoFE4eWa4b7oTCgX6vIUuQyrSsKrn6JRYy9GD+lfMnD53Dj0lc1lNC8GQyqM7kjoZNrlh80n0XPXToTo4xeXx9BI84xkAskyAqt7m6KTrcMSVDmjpt8yk9jV2Tpg2KmnRY1zP0EiRybRrh0lLke3E2feQ07Y0BYot2RUFKpWornT/zpSI62CrmDQ8qqw6xq7gUvoC8sSvOuizzMgS2bxOMkEks38CWa/HTdzId8nU9el4utZG+NFDMtiQewTJKzmwVRAG2/y+woUprfl8sEHGwbcXIeKWPjovjEKqVIt2eRHksK5bfcicamSyEnXDJsQWeuBvuoZQ4JI1CorqQRSaDBit9mSW57WqHJ2xgnckKq9KS9s2UiCUrXFyE1I5S8FOYfmRcj/En1W5UnwTuPwpU8ccoXbsmloJHuHNvztKwpjxvOx3j3krK35gE6ODoyysjCtM4g0VsuqikQu/NKoFYQvjkTfhw8k68EJUgikENHyajpnP1kxdQkyzs64ksDZG4k2+dDg2u+5kdZmfwsjbbz/KdLYNelZJDuJzC8+mXOSNJHPC/L80OaQXQ5b/FDwHV1/aiTsH9rK/S4ywpwxIlnfoqRBAzk8y4FGhAGxw0k1qCdEjskxbgYgjJqfOb8HSjbFNItJIaAnnz+JMiLj5koyV2/0FeopgoiDg1Y0ay7uPvT6Eno6LCNV9uzVls7+RIqwIiRo6XRjEhLjLOZYZX985Ag6kdqIeGRM13cRLwS1RIWISKlT2cTgp+duMrVkeVJNnwIay1Uk0JgPGBBWDhUDMkf4kEIgWUyEJTvqPyWDMQrOrqRw9nJBz7MThQ6tghwzG3OiF0FI9FyKPpOxI9t5IjVDuzASCTeLfiEbHpMg5xKjnb7IFG/Fvl4VGth/Qu7+gxIdzpy3jly76imQe0HJkvdJkmeQiEYEjQiapXPqOlx9gYpmbP9ECoFkNwZtIVfPyfS1h0NIOQPu3l4kcPZy9yZNBxIE3WnMtSBkwjUkC58RXq+8WTZhmicSNQrzDqkNQ3P+sYwE2RdVibkXi0xLy5vtiLWMQyHsXInyc6zpcJQEffH1JdkCW3TCv85/u5voqwE7UdWopriPVAIpjt6qqO30ytdJA+eRcgJ3NzfAxQucz3ojl7Mn7EIuNyl+nc+vZHdBLp+x30OkxsaPaNDgFCYVBnfl1bKVyOQZxwYoigVKy7tkbggVjkJuhylFNWdiSJYJndDG18jwMv/XkxjQRvPyMqkEUnxavknMsyIyg0iEL0rOTuDu7eJ6FjcUHB2MtKHIFSXZ2HXoBOxCxmIUw4OQiplo38HzFUIBYk+OeYpcTgt2wfPItyj5dltjD+NLQFsR8fSvpJheyfzsgjOAYKJ5H4UBhcTNX0klkGqrg6upsTWEjTqGlLszrq7g7Ya3N6pE7dtoDAgbeOQrqiaUCz2EXHT3EzPzQNTWHedRIX40oUj3DV9RcbRGnzpVLdoAwV7rz5DqQmGCSBDac5v1oE2hqClfPfYgaQTSzG1V2hQi/tiMjDcJ3N1Ih9cX5K72gYcXvS69RV3uduJMlGK3bMGgjNgVCGrUs3Ecal5Pm2N7oJzvUc2Bi+gLItmFxrwPRVUr4wf3SCOgp2rHcWXG+B5DwcUL3N1Iz2YUdu2H6AgMWlMk9hjfKcA/p0nlWXcuY0BERCXSEXsXQwppVqJHQN+uXajy1pAu//Ol3qEQHk56rOzZ68t3ujV32fH753p+4W9XVtyLHoG/w1MXvl++0lGL+W4rV/Iv4ZCdi/M3kkrgP+aBwH+R9yecZu0mjcA/knRGQuAfqgT+oUrgH6oEvsOp+j/P4d/BuPvUvJw7vjQaVW6uaPgXE9Dn9rNHjzj0ZIsLIYXZ9NpaE+N4/g26r0Okdq16E2+ixhVv0tOuwFyUjCa7s//s6li+iYC+7kKnh7PQE0iammM1onuOofF8H2dXZ8Db3Rs1zYw32A5/ez4YCUuCb1IkT51D09eh5IVB7Q9HQr9Z1vePIuewpW5MTOtWLToH8i0EZLKgL1tcCEk0gxdq0DBgdCQyOUpmblzP4ca+o/dQ4eWM91knZ2dnF2+UBi01RrsEpwtIrD339SUO1Xc7zLj0ADk3Z3AWvV1QGrFo/kSwtr1/BTlhb8S6X9+XWeYycDoqmrah0DPO7owhmUC6AkkhLBfFZytm2CBTYmDXV6FH71K+y9Tjo94i4+zq7O2Cjpezl7sb+vKU3wCWxoSF5kEu9h7w3nPhGLupHZFzIoGzqEFOKE5eEvwajJzpqRUhcKbJvWGrA5Ert6GIBdSgR7PJj0kiIOOAOu2t3BM8cs3eH4U+iz5TjA53J4FJ4wO2dZBxdXbxxs3J2d3F2csJfQ47qqPzZF3A6z32vS6gInbCT6WcUHAGF2dcETXIOPQhQXPuoBAxnQQvNw/KGYjcRXN8jpqGle7YqkI+kgjoe5tPUwV18T1ifBlhGSWip8TCBqfbhpEoNpz8mUOREPH2dvYCXHHzdnZzI5XDoQqxT2I6EPkebjVq5eqHGlEUkfMCd29vvL1wc0NGY3QeOFxbgyFC0egIFAJPD9JqQTPpdp7OO0kkoO9GTUQMuA829WJWo693g4FrSWY2R/MoFAln3N28nPF2xwvcnUmTZ0cFVo4hychGGd368q2cwQ3w1oiuTi5IidpDwBRRxJDqLp5PUKjyKQ4d8VWkjYYkAvrKk66p+ZdeQE+3oXvWkqzEPscv/ZByxdvLGXc3FMpXj105jWR+S0dYWkSiVM2RdLh4OTt7oyKjiCGV1jwbhVIACgL6btYiHcUHsB99pYQoklg0Xpiby/5IODt7uzp7u3sD3uCKng08GUOKKH867PJEaZw5Cs7gTiJvb2dnb6TC4iETZEJdk90W017xTQT0OZCOjAetf72CVIECL4DMbYeW+jl/P2ScccbbhQQuzjh7u5FirBUxpDIyIS4epRxlNUQi40yqs86ubkg9jRyR2wmmnERFib2FhFmzSYepEdEkEdBXVaPRoKoQQR4FH8+JQ9/4Uj+dn/+wwK9Eb2714rZmBwre7iTxduYsKXI1MaEDqQrMYttR9GRzaGSxnzvd84hBzZBxBW+SeLsi5aSpGAIYaTWoaVoUTU4Nhglbsj73+H/twQlcFfWiwPHf2LAo4o65hJZarnlNvSZWOJT6cN9TKy1TTNFLueWCeg4uuJua5VbuloKllFqayOCG5ZZL4HMXVErkoiIoqOf/DsuBmTlzKN/z9u79fPp+ySOjda0aAidV3ujr/qRI96XvFfR6DO8+1odPj36bQnFPgbMwlTyKhUJN/SlKlW8bCUKJrg9r4tFTAJU8CgYdhU0ANtF48kleGI/BZyeajXr7yuQHuNK5FzPIJ6NVGROdNnhgVwZW9zuKTsbUqZV9OIFdw2dxFqCST1FUKy5EcD+eQlWi/kaOVoILxzBQIIwi/TT8y2ru45Ei0JHfuB/x3XfL14Q+mIw5t1ETiNpAPpnf89QXnncX1O1Mdqp7ve8aX8UgOZlc3WEXehZU8lktBFDg+MHmvDcGhxUL0udRaNELZE5eXT/KC6rc4lFNWHfl49lA+ip0vKaV25XCtTemjS35IaYGTeObPvfIJ/N7+hY/NOToeiHmTPDZ2jQ0GBck6UIyOgoq+RQLYRS6uKOpXBOHp/qh4yXx6qGyb3sVs1HcelfFlRiFAIx+Xp2M3c2px2LRqVLlQApwfYTf0MUXcVa8+7ysOVOzcJDRkuwwkiLKf9ojO3glKe33BCUd+x5TjcU/0bMQSx4lhgAVjcnvl/mQfE992YT1aAjB1bHDKglbYtpzTcK6pKGlWrCoKlZaKqCq6EjSsddugSTxxXwMLlyo5p0OpK+c5Ykz+bM+bJxIIRmNWhUFezHYNq33bC70OQTc2Fln2onvMVWXePQU8lktagB6g6Y3jxp1/lomJap80eR+4jr09lUDzgyL3tLhZbX/UTRUVSGGPGoAeoOH37kFLBtRqWMIBlnJL1X7BSjV4bfrOHkmvNflnSFoyGhcTatMKgYnQwae+HhtNjm+CZbjMFWlOM5U7JQY1AAMvkqNKL+dZed4NggSn0NrZtMy1QXEv5ZC/67D65dHJ0whjxqmYvBPct15iIk3j+wbu1xqNbvG6FSM3p7y1OmQXWjJaDxRDGdi0SIcdv/45FRMZdkkCb0wi0XFaoEwFSeJ10sUZxB2N9euQyem6zYvLk/ZdAfSVkQWv4mOKllbKqhhKkUp334bBkmT5n06XSqVNXsxBiXHjxFLJyejI6Ph4528/yOK8gouNCkjBHpWiyIANUzF2YUGHfv0Aq7uHHUTg72lKJCejpGV3xMVnJ2MkyViQWnpTr0rGDy38W//PXQ3BjIaF73532oPCRiEWSDMigvf7rr53t551w/y+IWEYGbpUsx82GDp2FsYyTwe8ffENgysVopyNziYfwNtOnTYgTOZx2PpUv5D7ayEGZm/mJL5iymZv5iSeVy8xky0VUrhTxLr/3V3/pVkHpep/7CpWfw5nqjztC0LF6yT1r7N/5nMY9LtvXsd993n8bC2jAWsuNLyB+I/wFyf0aLHjASK0uSHm9OXUzQZvbkjSDo4MolHVXG5+8QYnLT6avJcHlmMggJYCLNipvMwWHwdU73XSnjuaphKEYaVKtV+OVp9V0uCYRtTKSCjE9Ezkqd6Nq+GqcBxPrU/+3oHzspFld65EmfjM+eSo9Y5jBSFlgog4UyNhZYKWFqGqTjr/CpxmzBVNVwCUa5cKi41+6j54bnRaL07TwhY9P6ij3GQ0Xg9CQk44IcZnzVthCQGDng+AaNyQ5rd+cevOGnkl0yOl7b/omSjZ1HIFROAUQC5FIuiKAEqTha9zbjrmJpXHZjPhrbXccFjwotERaAzyZv7WSWpNfvWOht5ZArMHQGR2PnhrG6ThK5tJJJSmtpimyZi0Huy6H0eZ5PcVpHDzetFv1j0FEANsFoUqxVzqmq1EBNmxagimZmY8goEdo+tPqDpdsw1Gt2OkWdwEjl6a2PcVrp/Rh4Zh4ieSfOZC0QQiVHo2BJCEnvDj96YMq580ET06o5+GLoDE50FrihAmBWrhZa4ZFVjaImTQRw+ghmvjSXh/NQH528NiM7C1IDexF7cjpMJv7Zu94k3nT4jj0w+v55J1SAO5vaMfB09r3HjhYR0QwGixkvdJqLj/olvwmxMTJBII0c5qRgGCmAFVEXBNVVVFAxq1WvORky1bwtExgJdvLMw8/EgkTlnO3qv+7DqKmnrP2zA3/9+iFwyBQ4CccwdMW8kBl3HCoE43Ra7lBSfePQ+9j/VHRMVg4TYQI5e4uJxnARgF6tQFAUVvZEjKkHrhGPudzMw8A0D/rmMHB1WYeL9YHFp8C4ManreXP4AiGpAxYGHyCWTLy6pp18cRPSMG4mB/xohhYeyIBE7Hx9pC1qen7yDNBw4tescOvWqMikVO996ZNxEz9oyVsXOghlFAVQVK4ShJwTQpcvPHpk/fngXnVefA4ZeJkclnHk8Oxiun8ag9ERuH8Rucu0etCGPjMNLiQd6RRzw6xWBgc9cIfpt7la76zLs6ggS0GrztqB+AwHcfecrtKpChn/VTpLo6M4OjALIp+LEasHOgl2Ait68Y7tuDztH/16lmqRa0ZK6Aglf4VK5Hs/CxfJXMPAgz4P78ORb68gh45BULXHjHN8WcbSBOboAAAxwSURBVBgtaSxtXs/EuRUAr3HjRVIiGs2+hNtZ4Rtgzls9v0IrE+YCkgBK4FIsTiwUUDEKZNt6+PG71d7Bi26gUb8j3H3jIVDWAzPJdaVito+P49LGPnhUJZdMgaSRc32T4jAK7SJO94Ov91QA1nQWYvgNNDp5Xh+tXsHux7fQ23y6vg3O/7ph60V+wZwVM6qCg6JiUIlN2EU1XRAoo9UB2HoCuwEVMfNuO2FLTMXo1oRpErn2SiCRS6bQB0lX/CJeR69JiHSjRyZw44bPlK4+4u7Xm9F4d0Ra55/IUXUIp9DrH1j/8KHDGfgJBOYsYMVJgBULaqxVsSgxEnptO5Pn3MbA4EkYzMDOKwQTVTrNKE7c7rM4EUKQSwgQ5JIpkHilBRE9545EZ3t5EZ5AjkFBjYUQ4eFoBXoc/okcjSJq7p+K3qFD5GqDKwqomLBixU5VFKxWdLp5n9lJvvfn3aSQBAmnAfehVSWRiVGv2cDsKP4YGQc/35fg9cQR85PQ8hHSjSYEMUhIQmLB5r1olfEXG7BrPKK727k+uHYNUzEQi4ESI+GaV11mZ2JXI3Ak42+jcQlO3YPgN5sjkldh1Am7KExIOJNx2EgSMGrj3NfREoLVkpCEEIhlm3ei516BdgfS3mnQziP18/A7uNAAtmBGAawYxKBjRae1H6+UgmfedCvJ52ttaEQl1G0Y/px/GVkghdxGL6J7MRvr+2Hm3L2qC0Y+AJ6ngIyDbyR2cRhs6VLMVswmcTRh39c3MLp1sHnbQODu5yFZuOQv7cGUBVSKoFgIQ6fcRuhHjrPTNmfa0MpcsKT2GEDAF7Ho+K5/QdjE7iRMRc72HfbRJag8ElI2kUumwFPgm7SfTej07foysJyjmMkaOcOfeytP7TqPa0opMQ0zigJhOLNayaXEgBWde8ebABvOsfLKA4x2Xa6OJODa+1ts6IS3AHZ3u4NL334+v3lUBU4vOk8uGYckv4hNPZr7xkWgk7l+PUX4MYDf5ePGNcwoEKZipCqWlrHYWUANQy+zGa5dbDf8bbcV8ft/TcTgmz6w/tM7uNDgw9B6sy2e7vcjjy8mj4xDrwM9e0JSL/40igVUnATEKIpCrjArj+T0e+9h6vjl0lPn49KdxZ3qFysl3TnRFwcZh7gWw3tGborgz2OBABVnATx2Z2pSpORGiwcxNHkLBWQKxMXxrxEZiakwRVX5dzFkCDoy/39UiX9fMn8xJfMXUzJ/MSXzF1MyfzElYxD45ltLx97k38LbKz+dc4nHyWuV/9BN/BEyev+1wdsWVKvbbXS8vNtOrE6xbfEgpay5ewuN2tZeSCz99khWGn+cVGnSYMHF1pdsuNRwphiSPI1HUWtnqpKBS08vayWGH76EQa0PaHCKvQeSKCSj5bnnbzIQ8P3EaAoUf46FLwsEtsBAkET4xbbnKPDyTg+BICjoWnril2tt/EHvLsMGT58NXXAXF57f6QMTbdN5BBOr7cnApbarK0i0WBmAXqM9XoKXGXJ9zcdXcJDReG5NEziV7seLYdEUGDcevWfanMOhwgKPtVb6hQq3tP39W3sut/GHlH6fh8vPvFy7/rS/v/4QM24dlpYneUnYW9Mx9XSFd3pLzc+i41EZh6cvYdRvmbtIWdzDv148OvGh5QQQ4jOyfbtE8skUqv9dVS6tXNTya8ikUHUc9hf/arskIIECfRolvQNLljw4/9OQIbGf3l2DM784crWuHXeEPD3qPwy3ssB3a4MuNc5ipsEmSfDjwo4NQhbixG9UuYalQRoyAp2yr5JArhEjDvdPQ6ffKkHQ+dgeGGV/TI75wZY6H3Unn0yBHh9VgRFR/BecHUChJW+SZ8qMJzIwqMdU4DrsAPpc6rMGoxJrWt+xZtFm9JTexTf1IleJIBZagaSZazH3QhTJEfXP3o5vOmohWqU9gkX/iu5nFhw6zK+Dp6Wi9TlsJ1elSh02t89A6xUYt/a+T73YeEzdnlFpWGccZBzcXq9CYs8jkAa9kygUV2t/pWLZNvdO23AiuZ2JINeS4xD4xH30lJE15Zp4LwFeLlucJPJkhrb9FDvf0aRnY+KFzVVTWscDi/uhU/f7qpI4sOebTUBVbj1Ey9LONvEkubyk7BUZ6AQFAWW23Z+FK5JEARmHGd1Jeu0C8BN4o5V6+8mbb/Xucwhnbv033yaXCt7jsmej9coYfy+yYltid77m+ZIn5pIvOhooMWFABfY/xFnNzb73WsVjVwq9Z+6R1lt9gF2zrxlyE42yQ213d5NnsFDX4MxHrbPiO1z4aJCIwkEmX+uBXAu8gN2FzBKd9qLh9yyntx2Mv4mzB9+Q5/l6nPCvMWcvhd7o/7I73BuzxF8SrIADg88ko9VwDBC4r+NJDOSBvuLLU+QYwzdobd/O8yfJ0f6jytO3oLWyXHbIQYq0vN7qIMyVi2zhdvkDHGTyNI3yeDj7NDlO3iqhoFH2Q5jCC94/7jkMm+6iZbv8Xs9Ib78JtUuUIMMteyoa1V+FzP2zo9lNOelBzXtrd6P331/uSxzt7/ttx5PohY9kZRD5fsTgJDmUWTXEBLQGtiJtBXlmwBqcTQ+8/gHm2mwsJS5PS8JBJle1Lz1YvZA8pys3ar+NAtUUFmdG+7nTUMBsdXI8Gtbn13ds4wMnGuLF0nQ0esK9f6wix+Buz8SFR2OQ9hYc7h3ua+19H63afYotDiZXq9dST2Gm+ufVjvdBq/5Cd5ZU7Fe3rSSgAimHMXIfMYa1/j7fXcOZ/0Zvzg/fTgGZXBNrkBFJvvCAYh234fBEqETwMFv29SWZdK/j00uZsuw+BW7uUt7ETsJuE1p104/O/g47zzaT3DJCjmLm+sJSYV28/4lGneFVDoWQZ5K4fgwTVX+oPms8Wt4bPSDMAhSzAcV+PYvRiGmIEcOljFlTcPJqKYr98tvTl3CQyRH4DozeSb59e/wbUKBfNwHZ6qxoYE6NFnMqLCg5E4eKX70obniUgsrH3epRN0ZQ6NUj2eTwjPYT0z9KxYVEDJoNJPwBuUKb/TADE1W/rzlnEjo96giwiQt3lmRC2Wle1zE686yIjv8+xWt+2IFojH5RW9o6dbq1PoR8MnbuPYqxbgUO2TfQaAtcfjeWXBcunN3PsGVp5Cl3rFLqqDXVmsOWbIKWLEz8lkJx5KiwsxEHZ3zDo4j7gVyhE9xmqTiTP6gXufABOseSK3P55yVHU7HrW4K1GKVUnjoTu6mR9aIxiox6yV/0rxgsB5NHxq5ufxh5HwePKmjUJXnRmmQcvOBIOnlKb6p0YNw+EhPJsbpXQC2MujT+m4h7LQvX6mIQTGYGOZT33b88jIn+w8XIq+j93KIMN5LJ04/UbRi9RJ5MzGTHxDB5Y/dXyCdj99vVqhQn3xPlFjbnCAXG1V1+kwLBM2HGA/I82dL2j59xyL6Fk/ZT67KnUxYmynonkqMbBk+R541VJ78dfhtnU96/P+wqRklJOCivsCgNV+rhin8bTpFPxu7Xg93ZvmBfycNQ23doJ7gwlwJbt+Lg1nhi22LZR89T4OHPFCj/IlfRqbauiWf64B3pmOmQnohdzVIkZOGkSt8Xa68LvocJ3yC3Tz+nKO5uZKI1J8OCQ5kP78dhqlWUZ1of8snk2NLes97S2+5XoUJpwBaWiJOy1Vq2aoe4umA2DreuPEmBOpGVLZFo+UY1PP/N6pOYO/v5sctQY3vFhDYZaN2qXH81LWqQ0eweZnZXiBlJ0QQpaCUsc5uWQZ4FFVYcxkhJ+YWFb3r83BsHmRxfbB0+oGopapIj7ecZuyjkMb0eSILK9SUBsYs3UeC310LnXrhyIvkelO09sULoTIFGla0N8NlwEhfu1BkX/VPX4JoJU66hM3NlpbcQ6TvmZ2DCa12ti1P4XcmVkym0offYsVMTDgOZfftmrMPJpKaZ+IjUQWdxkMl1O2zdiPq/kGPljUtotQ4BJMGFdZJgzZ4HaJwbMPPdRsSlwXO1rk6Yhc6oBqR/dRhXbqwOGpDtyenWyegdW/8m6376BHNTO97sEE/R+sHm1skUyujS8ZVXQiUhibvFM4JicRK2pQIcH3SEAjL5zg/FXGzCL5cZxabQ8zizjS7ZoVMvfou8sOPIb+gNt2VGDMKlXyfY+nuu3B3xAIOT/frhUtv3qJHG76gA0QfQytiwgaLEjl7C1FkZFJL5PenPA2Nw5c6GDW9gahinoynCtYEDeWTN3Hem8XsCeWSffYaezL/MJ/xLTONPIfOfJSyMP8f/ANmPgRrZoJXLAAAAAElFTkSuQmCC">
</div>
</div>
<p>We can preprocess the data as follows:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>i_train, i_val <span class="op">=</span> [], []</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k,v) <span class="kw">in</span> <span class="fu">group_indices</span>(y)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    _i_train, _i_val <span class="op">=</span> <span class="fu">splitobs</span>(v, at<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(i_train, _i_train<span class="op">...</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(i_val, _i_val<span class="op">...</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Xtrain, ytrain <span class="op">=</span> X[<span class="op">:</span>,<span class="op">:</span>,i_train], y_enc[<span class="op">:</span>,i_train]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Xval, yval <span class="op">=</span> X[<span class="op">:</span>,<span class="op">:</span>,i_val], y_enc[<span class="op">:</span>,i_val]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>([0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; … ;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0], Bool[0 0 … 0 0; 0 0 … 1 1; … ; 0 0 … 0 0; 0 0 … 0 0])</code></pre>
</div>
</div>
<p>Next, we define a data loader:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>batchsize <span class="op">=</span> <span class="fl">128</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>train_set <span class="op">=</span> <span class="fu">DataLoader</span>((Xtrain, ytrain), batchsize<span class="op">=</span>batchsize, shuffle<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>val_set <span class="op">=</span> <span class="fu">DataLoader</span>((Xval, yval), batchsize<span class="op">=</span>batchsize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>141-element DataLoader(::Tuple{Array{Float32, 3}, OneHotMatrix{UInt32, Vector{UInt32}}}, batchsize=128)
  with first element:
  (28×28×128 Array{Float32, 3}, 10×128 OneHotMatrix(::Vector{UInt32}) with eltype Bool,)</code></pre>
</div>
</div>
<p>We can now define a model, based on how we preprocessed the data:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Chain</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    Flux.flatten,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Dense</span>(<span class="fl">28</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">32</span>, relu),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Dense</span>(<span class="fl">32</span>, <span class="fl">10</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    softmax</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div class="ansi-escaped-output">
<pre>Chain(
  Flux.flatten,
  Dense(784 =&gt; 32, relu),               <span class="ansi-bright-black-fg"># 25_120 parameters</span>
  Dense(32 =&gt; 10),                      <span class="ansi-bright-black-fg"># 330 parameters</span>
  NNlib.softmax,
) <span class="ansi-bright-black-fg">                  # Total: 4 arrays, </span>25_450 parameters, 99.664 KiB.</pre>
</div>
</div>
</div>
<p>Finally, what’s left to do is to define a loss function and an optimiser:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loss</span>(y_hat, y) <span class="op">=</span> Flux.Losses.<span class="fu">crossentropy</span>(y_hat, y)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>opt_state <span class="op">=</span> Flux.<span class="fu">setup</span>(<span class="fu">Adam</span>(),model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before we start training, we define some helper functions:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Callbacks:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">accuracy</span>(model, data<span class="op">::</span><span class="dt">DataLoader</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x,y) <span class="kw">in</span> data</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        acc <span class="op">+=</span> <span class="fu">sum</span>(<span class="fu">onecold</span>(<span class="fu">model</span>(x)) <span class="op">.==</span> <span class="fu">onecold</span>(y)) <span class="op">/</span> <span class="fu">size</span>(y,<span class="fl">2</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> acc <span class="op">/</span> <span class="fu">length</span>(data)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">avg_loss</span>(model, data<span class="op">::</span><span class="dt">DataLoader</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    _loss <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x,y) <span class="kw">in</span> data</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        _loss <span class="op">+=</span> <span class="fu">loss</span>(<span class="fu">model</span>(x), y)[<span class="fl">1</span>]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _loss <span class="op">/</span> <span class="fu">length</span>(data)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As a very last step, we set up our training logs:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final setup:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>nepochs <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>log <span class="op">=</span> []</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>acc_train, acc_val <span class="op">=</span> <span class="fu">accuracy</span>(model, train_set), <span class="fu">accuracy</span>(model, val_set)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>loss_train, loss_val <span class="op">=</span> <span class="fu">avg_loss</span>(model, train_set), <span class="fu">avg_loss</span>(model, val_set)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>epoch <span class="op">=&gt;</span> <span class="fl">0</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>acc_train <span class="op">=&gt;</span> acc_train,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>acc_val <span class="op">=&gt;</span> acc_val,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>loss_train <span class="op">=&gt;</span> loss_train,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>loss_val <span class="op">=&gt;</span> loss_val</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(log, results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below we finally train our model:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training loop:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>nepochs</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i, data) <span class="kw">in</span> <span class="fu">enumerate</span>(train_set)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract data:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        input, label <span class="op">=</span> data</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute loss and gradient:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        val, grads <span class="op">=</span> Flux.<span class="fu">withgradient</span>(model) <span class="cf">do</span> m</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> <span class="fu">m</span>(input)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">loss</span>(result, label)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Detect loss of Inf or NaN. Print a warning, and then skip update!</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> !<span class="fu">isfinite</span>(val)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>            <span class="pp">@warn</span> <span class="st">"loss is </span><span class="sc">$</span>val<span class="st"> on item </span><span class="sc">$</span>i<span class="st">"</span> epoch</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        Flux.<span class="fu">update!</span>(opt_state, model, grads[<span class="fl">1</span>])</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Monitor progress:</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    acc_train, acc_val <span class="op">=</span> <span class="fu">accuracy</span>(model, train_set), <span class="fu">accuracy</span>(model, val_set)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    loss_train, loss_val <span class="op">=</span> <span class="fu">avg_loss</span>(model, train_set), <span class="fu">avg_loss</span>(model, val_set)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>epoch <span class="op">=&gt;</span> epoch,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>acc_train <span class="op">=&gt;</span> acc_train,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>acc_val <span class="op">=&gt;</span> acc_val,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>loss_train <span class="op">=&gt;</span> loss_train,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span>loss_val <span class="op">=&gt;</span> loss_val</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(log, results)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print progress:</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    results_df <span class="op">=</span> <span class="fu">DataFrame</span>(log)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    vals <span class="op">=</span> <span class="fu">Matrix</span>(results_df[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>,[<span class="op">:</span>loss_train,<span class="op">:</span>loss_val]])</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    plt <span class="op">=</span> UnicodePlots.<span class="fu">lineplot</span>(<span class="fl">1</span><span class="op">:</span>epoch, vals; </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>[<span class="st">"Train"</span>,<span class="st">"Validation"</span>], title<span class="op">=</span><span class="st">"Loss in epoch </span><span class="sc">$</span>epoch<span class="st">"</span>, xlim<span class="op">=</span>(<span class="fl">1</span>,nepochs))</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    UnicodePlots.<span class="fu">display</span>(plt)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-mnist">Figure&nbsp;<span>2.2</span></a> shows the training and validation loss and accuracy over epochs. The model is overfitting, as the validation loss increases after bottoming out at around epoch 20.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> <span class="fu">DataFrame</span>(log)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> output[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>,<span class="op">:</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> <span class="pp">@animate</span> <span class="cf">for</span> epoch <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">maximum</span>(output.epoch)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    p_loss <span class="op">=</span> <span class="fu">plot</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,<span class="op">:</span>epoch], <span class="fu">Matrix</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,[<span class="op">:</span>loss_train,<span class="op">:</span>loss_val]]), </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>[<span class="st">"Train"</span> <span class="st">"Validation"</span>], title<span class="op">=</span><span class="st">"Loss"</span>, legend<span class="op">=:</span>topleft)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    p_acc <span class="op">=</span> <span class="fu">plot</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,<span class="op">:</span>epoch], <span class="fu">Matrix</span>(output[<span class="fl">1</span><span class="op">:</span>epoch,[<span class="op">:</span>acc_train,<span class="op">:</span>acc_val]]), </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>[<span class="st">"Train"</span> <span class="st">"Validation"</span>], title<span class="op">=</span><span class="st">"Accuracy"</span>, legend<span class="op">=:</span>topleft)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(p_loss, p_acc, layout<span class="op">=</span>(<span class="fl">1</span>,<span class="fl">2</span>), dpi<span class="op">=</span><span class="fl">300</span>, margin<span class="op">=</span><span class="fl">5</span>mm, size<span class="op">=</span>(<span class="fl">800</span>,<span class="fl">400</span>))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">gif</span>(anim, <span class="fu">joinpath</span>(www_path, <span class="st">"c4_mnist.gif"</span>), fps<span class="op">=</span><span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-mnist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../www/c4_mnist.gif" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.2: Training and validation loss and accuracy</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../summary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>